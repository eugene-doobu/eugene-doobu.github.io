(()=>{var t={91:(t,e,r)=>{t.exports=r(122)},122:t=>{var e=null;t.exports=function(t,r){var n=t.length;return r=r||2,e&&e[n]||function(t){(e=e||{})[t]=new Array(t*t);for(var r=Math.PI/t,n=0;n<t;n++)for(var a=0;a<t;a++)e[t][a+n*t]=Math.cos(r*(a+.5)*n)}(n),t.map((function(){return 0})).map((function(a,i){return r*t.reduce((function(t,r,a,o){return t+r*e[n][a+i*n]}),0)}))}},196:(t,e,r)=>{"use strict";var n=r(61),a=function(t){var e={};void 0===t.real||void 0===t.imag?e=n.constructComplexArray(t):(e.real=t.real.slice(),e.imag=t.imag.slice());var r=e.real.length,a=Math.log2(r);if(Math.round(a)!=a)throw new Error("Input size must be a power of 2.");if(e.real.length!=e.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var i=n.bitReverseArray(r),o={real:[],imag:[]},s=0;s<r;s++)o.real[i[s]]=e.real[s],o.imag[i[s]]=e.imag[s];for(var u=0;u<r;u++)e.real[u]=o.real[u],e.imag[u]=o.imag[u];for(var c=1;c<=a;c++)for(var h=Math.pow(2,c),l=0;l<h/2;l++)for(var f=n.euler(l,h),m=0;m<r/h;m++){var d=h*m+l,p=h*m+l+h/2,v={real:e.real[d],imag:e.imag[d]},M={real:e.real[p],imag:e.imag[p]},g=n.multiply(f,M),b=n.subtract(v,g);e.real[p]=b.real,e.imag[p]=b.imag;var y=n.add(g,v);e.real[d]=y.real,e.imag[d]=y.imag}return e};t.exports={fft:a,ifft:function(t){if(void 0===t.real||void 0===t.imag)throw new Error("IFFT only accepts a complex input.");for(var e=t.real.length,r={real:[],imag:[]},i=0;i<e;i++){var o={real:t.real[i],imag:t.imag[i]},s=n.conj(o);r.real[i]=s.real,r.imag[i]=s.imag}var u=a(r);return r.real=u.real.map((function(t){return t/e})),r.imag=u.imag.map((function(t){return t/e})),r}}},61:t=>{"use strict";function e(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}var r={},n={};t.exports={bitReverseArray:function(t){if(void 0===r[t]){for(var n=(t-1).toString(2).length,a="0".repeat(n),i={},o=0;o<t;o++){var s=o.toString(2);s=a.substr(s.length)+s,s=[].concat(e(s)).reverse().join(""),i[o]=parseInt(s,2)}r[t]=i}return r[t]},multiply:function(t,e){return{real:t.real*e.real-t.imag*e.imag,imag:t.real*e.imag+t.imag*e.real}},add:function(t,e){return{real:t.real+e.real,imag:t.imag+e.imag}},subtract:function(t,e){return{real:t.real-e.real,imag:t.imag-e.imag}},euler:function(t,e){var r=-2*Math.PI*t/e;return{real:Math.cos(r),imag:Math.sin(r)}},conj:function(t){return t.imag*=-1,t},constructComplexArray:function(t){var e={};e.real=void 0===t.real?t.slice():t.real.slice();var r=e.real.length;return void 0===n[r]&&(n[r]=Array.apply(null,Array(r)).map(Number.prototype.valueOf,0)),e.imag=n[r].slice(),e}}},659:(t,e,r)=>{"use strict";r.r(e),r.d(e,{glMatrix:()=>n,mat2:()=>a,mat2d:()=>i,mat3:()=>o,mat4:()=>s,quat:()=>h,quat2:()=>l,vec2:()=>f,vec3:()=>u,vec4:()=>c});var n={};r.r(n),r.d(n,{ARRAY_TYPE:()=>d,EPSILON:()=>m,RANDOM:()=>p,equals:()=>b,setMatrixArrayType:()=>v,toRadian:()=>g});var a={};r.r(a),r.d(a,{LDU:()=>D,add:()=>z,adjoint:()=>E,clone:()=>w,copy:()=>x,create:()=>y,determinant:()=>B,equals:()=>G,exactEquals:()=>U,frob:()=>j,fromRotation:()=>q,fromScaling:()=>C,fromValues:()=>_,identity:()=>S,invert:()=>P,mul:()=>N,multiply:()=>O,multiplyScalar:()=>k,multiplyScalarAndAdd:()=>V,rotate:()=>T,scale:()=>R,set:()=>A,str:()=>I,sub:()=>X,subtract:()=>L,transpose:()=>F});var i={};r.r(i),r.d(i,{add:()=>ct,clone:()=>$,copy:()=>Z,create:()=>Y,determinant:()=>J,equals:()=>dt,exactEquals:()=>mt,frob:()=>ut,fromRotation:()=>at,fromScaling:()=>it,fromTranslation:()=>ot,fromValues:()=>Q,identity:()=>K,invert:()=>H,mul:()=>pt,multiply:()=>tt,multiplyScalar:()=>lt,multiplyScalarAndAdd:()=>ft,rotate:()=>et,scale:()=>rt,set:()=>W,str:()=>st,sub:()=>vt,subtract:()=>ht,translate:()=>nt});var o={};r.r(o),r.d(o,{add:()=>Gt,adjoint:()=>Ft,clone:()=>bt,copy:()=>yt,create:()=>Mt,determinant:()=>Pt,equals:()=>Yt,exactEquals:()=>Xt,frob:()=>Ut,fromMat2d:()=>It,fromMat4:()=>gt,fromQuat:()=>jt,fromRotation:()=>qt,fromScaling:()=>Ct,fromTranslation:()=>Rt,fromValues:()=>wt,identity:()=>St,invert:()=>At,mul:()=>$t,multiply:()=>Et,multiplyScalar:()=>Vt,multiplyScalarAndAdd:()=>Nt,normalFromMat4:()=>Dt,projection:()=>zt,rotate:()=>Ot,scale:()=>Tt,set:()=>xt,str:()=>Lt,sub:()=>Zt,subtract:()=>kt,translate:()=>Bt,transpose:()=>_t});var s={};r.r(s),r.d(s,{add:()=>ze,adjoint:()=>ne,clone:()=>Qt,copy:()=>Wt,create:()=>Kt,determinant:()=>ae,equals:()=>Ve,exactEquals:()=>ke,frob:()=>De,fromQuat:()=>Ae,fromQuat2:()=>be,fromRotation:()=>de,fromRotationTranslation:()=>ge,fromRotationTranslationScale:()=>Se,fromRotationTranslationScaleOrigin:()=>_e,fromScaling:()=>me,fromTranslation:()=>fe,fromValues:()=>Ht,fromXRotation:()=>pe,fromYRotation:()=>ve,fromZRotation:()=>Me,frustum:()=>Fe,getRotation:()=>xe,getScaling:()=>we,getTranslation:()=>ye,identity:()=>te,invert:()=>re,lookAt:()=>Ce,mul:()=>Ne,multiply:()=>ie,multiplyScalar:()=>Ue,multiplyScalarAndAdd:()=>Ge,ortho:()=>Re,orthoNO:()=>Te,orthoZO:()=>qe,perspective:()=>Ee,perspectiveFromFieldOfView:()=>Oe,perspectiveNO:()=>Pe,perspectiveZO:()=>Be,rotate:()=>ue,rotateX:()=>ce,rotateY:()=>he,rotateZ:()=>le,scale:()=>se,set:()=>Jt,str:()=>je,sub:()=>Xe,subtract:()=>Le,targetTo:()=>Ie,translate:()=>oe,transpose:()=>ee});var u={};r.r(u),r.d(u,{add:()=>He,angle:()=>Pr,bezier:()=>br,ceil:()=>rr,clone:()=>$e,copy:()=>Qe,create:()=>Ye,cross:()=>vr,dist:()=>jr,distance:()=>cr,div:()=>Ir,divide:()=>er,dot:()=>pr,equals:()=>Tr,exactEquals:()=>Or,floor:()=>nr,forEach:()=>Ur,fromValues:()=>Ke,hermite:()=>gr,inverse:()=>mr,len:()=>zr,length:()=>Ze,lerp:()=>Mr,max:()=>ir,min:()=>ar,mul:()=>Cr,multiply:()=>tr,negate:()=>fr,normalize:()=>dr,random:()=>yr,rotateX:()=>_r,rotateY:()=>Ar,rotateZ:()=>Fr,round:()=>or,scale:()=>sr,scaleAndAdd:()=>ur,set:()=>We,sqrDist:()=>Dr,sqrLen:()=>Lr,squaredDistance:()=>hr,squaredLength:()=>lr,str:()=>Br,sub:()=>qr,subtract:()=>Je,transformMat3:()=>xr,transformMat4:()=>wr,transformQuat:()=>Sr,zero:()=>Er});var c={};r.r(c),r.d(c,{add:()=>Yr,ceil:()=>Qr,clone:()=>kr,copy:()=>Nr,create:()=>Gr,cross:()=>fn,dist:()=>_n,distance:()=>nn,div:()=>Sn,divide:()=>Kr,dot:()=>ln,equals:()=>yn,exactEquals:()=>bn,floor:()=>Wr,forEach:()=>En,fromValues:()=>Vr,inverse:()=>cn,len:()=>Fn,length:()=>on,lerp:()=>mn,max:()=>Jr,min:()=>Hr,mul:()=>xn,multiply:()=>Zr,negate:()=>un,normalize:()=>hn,random:()=>dn,round:()=>tn,scale:()=>en,scaleAndAdd:()=>rn,set:()=>Xr,sqrDist:()=>An,sqrLen:()=>Pn,squaredDistance:()=>an,squaredLength:()=>sn,str:()=>gn,sub:()=>wn,subtract:()=>$r,transformMat4:()=>pn,transformQuat:()=>vn,zero:()=>Mn});var h={};r.r(h),r.d(h,{add:()=>ia,calculateW:()=>zn,clone:()=>ea,conjugate:()=>Xn,copy:()=>na,create:()=>Bn,dot:()=>ua,equals:()=>va,exactEquals:()=>pa,exp:()=>Ln,fromEuler:()=>$n,fromMat3:()=>Yn,fromValues:()=>ra,getAngle:()=>qn,getAxisAngle:()=>Rn,identity:()=>On,invert:()=>Nn,len:()=>la,length:()=>ha,lerp:()=>ca,ln:()=>Un,mul:()=>oa,multiply:()=>Cn,normalize:()=>da,pow:()=>Gn,random:()=>Vn,rotateX:()=>In,rotateY:()=>jn,rotateZ:()=>Dn,rotationTo:()=>Ma,scale:()=>sa,set:()=>aa,setAxes:()=>ba,setAxisAngle:()=>Tn,slerp:()=>kn,sqlerp:()=>ga,sqrLen:()=>ma,squaredLength:()=>fa,str:()=>Zn});var l={};r.r(l),r.d(l,{add:()=>Va,clone:()=>wa,conjugate:()=>Qa,copy:()=>Ea,create:()=>ya,dot:()=>$a,equals:()=>ai,exactEquals:()=>ni,fromMat4:()=>Pa,fromRotation:()=>Fa,fromRotationTranslation:()=>_a,fromRotationTranslationValues:()=>Sa,fromTranslation:()=>Aa,fromValues:()=>xa,getDual:()=>Ra,getReal:()=>Ta,getTranslation:()=>Ia,identity:()=>Ba,invert:()=>Ka,len:()=>Ha,length:()=>Wa,lerp:()=>Za,mul:()=>Xa,multiply:()=>Na,normalize:()=>ei,rotateAroundAxis:()=>ka,rotateByQuatAppend:()=>Ua,rotateByQuatPrepend:()=>Ga,rotateX:()=>Da,rotateY:()=>za,rotateZ:()=>La,scale:()=>Ya,set:()=>Oa,setDual:()=>Ca,setReal:()=>qa,sqrLen:()=>ti,squaredLength:()=>Ja,str:()=>ri,translate:()=>ja});var f={};r.r(f),r.d(f,{add:()=>hi,angle:()=>Di,ceil:()=>di,clone:()=>oi,copy:()=>ui,create:()=>ii,cross:()=>Bi,dist:()=>Yi,distance:()=>wi,div:()=>Xi,divide:()=>mi,dot:()=>Ei,equals:()=>Gi,exactEquals:()=>Ui,floor:()=>pi,forEach:()=>Ki,fromValues:()=>si,inverse:()=>Fi,len:()=>ki,length:()=>Si,lerp:()=>Oi,max:()=>Mi,min:()=>vi,mul:()=>Ni,multiply:()=>fi,negate:()=>Ai,normalize:()=>Pi,random:()=>Ti,rotate:()=>ji,round:()=>gi,scale:()=>bi,scaleAndAdd:()=>yi,set:()=>ci,sqrDist:()=>$i,sqrLen:()=>Zi,squaredDistance:()=>xi,squaredLength:()=>_i,str:()=>Li,sub:()=>Vi,subtract:()=>li,transformMat2:()=>Ri,transformMat2d:()=>qi,transformMat3:()=>Ci,transformMat4:()=>Ii,zero:()=>zi});var m=1e-6,d="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function v(t){d=t}var M=Math.PI/180;function g(t){return t*M}function b(t,e){return Math.abs(t-e)<=m*Math.max(1,Math.abs(t),Math.abs(e))}function y(){var t=new d(4);return d!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function w(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function x(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function S(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function _(t,e,r,n){var a=new d(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function A(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t}function F(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function P(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*i-a*n;return o?(o=1/o,t[0]=i*o,t[1]=-n*o,t[2]=-a*o,t[3]=r*o,t):null}function E(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function B(t){return t[0]*t[3]-t[2]*t[1]}function O(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],c=r[2],h=r[3];return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=n*c+i*h,t[3]=a*c+o*h,t}function T(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=a*u+o*s,t[2]=n*-s+i*u,t[3]=a*-s+o*u,t}function R(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=a*s,t[2]=i*u,t[3]=o*u,t}function q(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function C(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function I(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function j(t){return Math.hypot(t[0],t[1],t[2],t[3])}function D(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function z(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function L(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function U(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function G(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=m*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=m*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=m*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=m*Math.max(1,Math.abs(i),Math.abs(c))}function k(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function V(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var N=O,X=L;function Y(){var t=new d(6);return d!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function $(t){var e=new d(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Z(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function K(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Q(t,e,r,n,a,i){var o=new d(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=a,o[5]=i,o}function W(t,e,r,n,a,i,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t}function H(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=r*i-n*a;return u?(u=1/u,t[0]=i*u,t[1]=-n*u,t[2]=-a*u,t[3]=r*u,t[4]=(a*s-i*o)*u,t[5]=(n*o-r*s)*u,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],h=r[1],l=r[2],f=r[3],m=r[4],d=r[5];return t[0]=n*c+i*h,t[1]=a*c+o*h,t[2]=n*l+i*f,t[3]=a*l+o*f,t[4]=n*m+i*d+s,t[5]=a*m+o*d+u,t}function et(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=Math.sin(r),h=Math.cos(r);return t[0]=n*h+i*c,t[1]=a*h+o*c,t[2]=n*-c+i*h,t[3]=a*-c+o*h,t[4]=s,t[5]=u,t}function rt(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],h=r[1];return t[0]=n*c,t[1]=a*c,t[2]=i*h,t[3]=o*h,t[4]=s,t[5]=u,t}function nt(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],h=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=n*c+i*h+s,t[5]=a*c+o*h+u,t}function at(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function it(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function ht(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function lt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function ft(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function mt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function dt(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=e[0],c=e[1],h=e[2],l=e[3],f=e[4],d=e[5];return Math.abs(r-u)<=m*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=m*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-h)<=m*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-l)<=m*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-f)<=m*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-d)<=m*Math.max(1,Math.abs(s),Math.abs(d))}var pt=tt,vt=ht;function Mt(){var t=new d(9);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new d(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function wt(t,e,r,n,a,i,o,s,u){var c=new d(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=i,c[6]=o,c[7]=s,c[8]=u,c}function xt(t,e,r,n,a,i,o,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t}function St(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function _t(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function At(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=h*o-s*c,f=-h*i+s*u,m=c*i-o*u,d=r*l+n*f+a*m;return d?(d=1/d,t[0]=l*d,t[1]=(-h*n+a*c)*d,t[2]=(s*n-a*o)*d,t[3]=f*d,t[4]=(h*r-a*u)*d,t[5]=(-s*r+a*i)*d,t[6]=m*d,t[7]=(-c*r+n*u)*d,t[8]=(o*r-n*i)*d,t):null}function Ft(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8];return t[0]=o*h-s*c,t[1]=a*c-n*h,t[2]=n*s-a*o,t[3]=s*u-i*h,t[4]=r*h-a*u,t[5]=a*i-r*s,t[6]=i*c-o*u,t[7]=n*u-r*c,t[8]=r*o-n*i,t}function Pt(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*(c*i-o*u)+r*(-c*a+o*s)+n*(u*a-i*s)}function Et(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=r[0],m=r[1],d=r[2],p=r[3],v=r[4],M=r[5],g=r[6],b=r[7],y=r[8];return t[0]=f*n+m*o+d*c,t[1]=f*a+m*s+d*h,t[2]=f*i+m*u+d*l,t[3]=p*n+v*o+M*c,t[4]=p*a+v*s+M*h,t[5]=p*i+v*u+M*l,t[6]=g*n+b*o+y*c,t[7]=g*a+b*s+y*h,t[8]=g*i+b*u+y*l,t}function Bt(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=r[0],m=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=f*n+m*o+c,t[7]=f*a+m*s+h,t[8]=f*i+m*u+l,t}function Ot(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=Math.sin(r),m=Math.cos(r);return t[0]=m*n+f*o,t[1]=m*a+f*s,t[2]=m*i+f*u,t[3]=m*o-f*n,t[4]=m*s-f*a,t[5]=m*u-f*i,t[6]=c,t[7]=h,t[8]=l,t}function Tt(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Rt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function qt(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ct(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function jt(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,c=r*o,h=n*o,l=n*s,f=a*o,m=a*s,d=a*u,p=i*o,v=i*s,M=i*u;return t[0]=1-l-d,t[3]=h-M,t[6]=f+v,t[1]=h+M,t[4]=1-c-d,t[7]=m-p,t[2]=f-v,t[5]=m+p,t[8]=1-c-l,t}function Dt(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],m=e[11],d=e[12],p=e[13],v=e[14],M=e[15],g=r*s-n*o,b=r*u-a*o,y=r*c-i*o,w=n*u-a*s,x=n*c-i*s,S=a*c-i*u,_=h*p-l*d,A=h*v-f*d,F=h*M-m*d,P=l*v-f*p,E=l*M-m*p,B=f*M-m*v,O=g*B-b*E+y*P+w*F-x*A+S*_;return O?(O=1/O,t[0]=(s*B-u*E+c*P)*O,t[1]=(u*F-o*B-c*A)*O,t[2]=(o*E-s*F+c*_)*O,t[3]=(a*E-n*B-i*P)*O,t[4]=(r*B-a*F+i*A)*O,t[5]=(n*F-r*E-i*_)*O,t[6]=(p*S-v*x+M*w)*O,t[7]=(v*y-d*S-M*b)*O,t[8]=(d*x-p*y+M*g)*O,t):null}function zt(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Lt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Gt(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function kt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Vt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function Nt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Xt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Yt(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=e[0],f=e[1],d=e[2],p=e[3],v=e[4],M=e[5],g=e[6],b=e[7],y=e[8];return Math.abs(r-l)<=m*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=m*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-d)<=m*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-p)<=m*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-v)<=m*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-M)<=m*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-g)<=m*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-b)<=m*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(h-y)<=m*Math.max(1,Math.abs(h),Math.abs(y))}var $t=Et,Zt=kt;function Kt(){var t=new d(16);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Qt(t){var e=new d(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Wt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ht(t,e,r,n,a,i,o,s,u,c,h,l,f,m,p,v){var M=new d(16);return M[0]=t,M[1]=e,M[2]=r,M[3]=n,M[4]=a,M[5]=i,M[6]=o,M[7]=s,M[8]=u,M[9]=c,M[10]=h,M[11]=l,M[12]=f,M[13]=m,M[14]=p,M[15]=v,M}function Jt(t,e,r,n,a,i,o,s,u,c,h,l,f,m,d,p,v){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=l,t[11]=f,t[12]=m,t[13]=d,t[14]=p,t[15]=v,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function re(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],m=e[11],d=e[12],p=e[13],v=e[14],M=e[15],g=r*s-n*o,b=r*u-a*o,y=r*c-i*o,w=n*u-a*s,x=n*c-i*s,S=a*c-i*u,_=h*p-l*d,A=h*v-f*d,F=h*M-m*d,P=l*v-f*p,E=l*M-m*p,B=f*M-m*v,O=g*B-b*E+y*P+w*F-x*A+S*_;return O?(O=1/O,t[0]=(s*B-u*E+c*P)*O,t[1]=(a*E-n*B-i*P)*O,t[2]=(p*S-v*x+M*w)*O,t[3]=(f*x-l*S-m*w)*O,t[4]=(u*F-o*B-c*A)*O,t[5]=(r*B-a*F+i*A)*O,t[6]=(v*y-d*S-M*b)*O,t[7]=(h*S-f*y+m*b)*O,t[8]=(o*E-s*F+c*_)*O,t[9]=(n*F-r*E-i*_)*O,t[10]=(d*x-p*y+M*g)*O,t[11]=(l*y-h*x-m*g)*O,t[12]=(s*A-o*P-u*_)*O,t[13]=(r*P-n*A+a*_)*O,t[14]=(p*b-d*w-v*g)*O,t[15]=(h*w-l*b+f*g)*O,t):null}function ne(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],m=e[11],d=e[12],p=e[13],v=e[14],M=e[15];return t[0]=s*(f*M-m*v)-l*(u*M-c*v)+p*(u*m-c*f),t[1]=-(n*(f*M-m*v)-l*(a*M-i*v)+p*(a*m-i*f)),t[2]=n*(u*M-c*v)-s*(a*M-i*v)+p*(a*c-i*u),t[3]=-(n*(u*m-c*f)-s*(a*m-i*f)+l*(a*c-i*u)),t[4]=-(o*(f*M-m*v)-h*(u*M-c*v)+d*(u*m-c*f)),t[5]=r*(f*M-m*v)-h*(a*M-i*v)+d*(a*m-i*f),t[6]=-(r*(u*M-c*v)-o*(a*M-i*v)+d*(a*c-i*u)),t[7]=r*(u*m-c*f)-o*(a*m-i*f)+h*(a*c-i*u),t[8]=o*(l*M-m*p)-h*(s*M-c*p)+d*(s*m-c*l),t[9]=-(r*(l*M-m*p)-h*(n*M-i*p)+d*(n*m-i*l)),t[10]=r*(s*M-c*p)-o*(n*M-i*p)+d*(n*c-i*s),t[11]=-(r*(s*m-c*l)-o*(n*m-i*l)+h*(n*c-i*s)),t[12]=-(o*(l*v-f*p)-h*(s*v-u*p)+d*(s*f-u*l)),t[13]=r*(l*v-f*p)-h*(n*v-a*p)+d*(n*f-a*l),t[14]=-(r*(s*v-u*p)-o*(n*v-a*p)+d*(n*u-a*s)),t[15]=r*(s*f-u*l)-o*(n*f-a*l)+h*(n*u-a*s),t}function ae(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],h=t[9],l=t[10],f=t[11],m=t[12],d=t[13],p=t[14],v=t[15];return(e*o-r*i)*(l*v-f*p)-(e*s-n*i)*(h*v-f*d)+(e*u-a*i)*(h*p-l*d)+(r*s-n*o)*(c*v-f*m)-(r*u-a*o)*(c*p-l*m)+(n*u-a*s)*(c*d-h*m)}function ie(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],m=e[10],d=e[11],p=e[12],v=e[13],M=e[14],g=e[15],b=r[0],y=r[1],w=r[2],x=r[3];return t[0]=b*n+y*s+w*l+x*p,t[1]=b*a+y*u+w*f+x*v,t[2]=b*i+y*c+w*m+x*M,t[3]=b*o+y*h+w*d+x*g,b=r[4],y=r[5],w=r[6],x=r[7],t[4]=b*n+y*s+w*l+x*p,t[5]=b*a+y*u+w*f+x*v,t[6]=b*i+y*c+w*m+x*M,t[7]=b*o+y*h+w*d+x*g,b=r[8],y=r[9],w=r[10],x=r[11],t[8]=b*n+y*s+w*l+x*p,t[9]=b*a+y*u+w*f+x*v,t[10]=b*i+y*c+w*m+x*M,t[11]=b*o+y*h+w*d+x*g,b=r[12],y=r[13],w=r[14],x=r[15],t[12]=b*n+y*s+w*l+x*p,t[13]=b*a+y*u+w*f+x*v,t[14]=b*i+y*c+w*m+x*M,t[15]=b*o+y*h+w*d+x*g,t}function oe(t,e,r){var n,a,i,o,s,u,c,h,l,f,m,d,p=r[0],v=r[1],M=r[2];return e===t?(t[12]=e[0]*p+e[4]*v+e[8]*M+e[12],t[13]=e[1]*p+e[5]*v+e[9]*M+e[13],t[14]=e[2]*p+e[6]*v+e[10]*M+e[14],t[15]=e[3]*p+e[7]*v+e[11]*M+e[15]):(n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],m=e[10],d=e[11],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=l,t[9]=f,t[10]=m,t[11]=d,t[12]=n*p+s*v+l*M+e[12],t[13]=a*p+u*v+f*M+e[13],t[14]=i*p+c*v+m*M+e[14],t[15]=o*p+h*v+d*M+e[15]),t}function se(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,r,n){var a,i,o,s,u,c,h,l,f,d,p,v,M,g,b,y,w,x,S,_,A,F,P,E,B=n[0],O=n[1],T=n[2],R=Math.hypot(B,O,T);return R<m?null:(B*=R=1/R,O*=R,T*=R,a=Math.sin(r),o=1-(i=Math.cos(r)),s=e[0],u=e[1],c=e[2],h=e[3],l=e[4],f=e[5],d=e[6],p=e[7],v=e[8],M=e[9],g=e[10],b=e[11],y=B*B*o+i,w=O*B*o+T*a,x=T*B*o-O*a,S=B*O*o-T*a,_=O*O*o+i,A=T*O*o+B*a,F=B*T*o+O*a,P=O*T*o-B*a,E=T*T*o+i,t[0]=s*y+l*w+v*x,t[1]=u*y+f*w+M*x,t[2]=c*y+d*w+g*x,t[3]=h*y+p*w+b*x,t[4]=s*S+l*_+v*A,t[5]=u*S+f*_+M*A,t[6]=c*S+d*_+g*A,t[7]=h*S+p*_+b*A,t[8]=s*F+l*P+v*E,t[9]=u*F+f*P+M*E,t[10]=c*F+d*P+g*E,t[11]=h*F+p*P+b*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+c*n,t[5]=o*a+h*n,t[6]=s*a+l*n,t[7]=u*a+f*n,t[8]=c*a-i*n,t[9]=h*a-o*n,t[10]=l*a-s*n,t[11]=f*a-u*n,t}function he(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],c=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-c*n,t[1]=o*a-h*n,t[2]=s*a-l*n,t[3]=u*a-f*n,t[8]=i*n+c*a,t[9]=o*n+h*a,t[10]=s*n+l*a,t[11]=u*n+f*a,t}function le(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],c=e[4],h=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+c*n,t[1]=o*a+h*n,t[2]=s*a+l*n,t[3]=u*a+f*n,t[4]=c*a-i*n,t[5]=h*a-o*n,t[6]=l*a-s*n,t[7]=f*a-u*n,t}function fe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function me(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function de(t,e,r){var n,a,i,o=r[0],s=r[1],u=r[2],c=Math.hypot(o,s,u);return c<m?null:(o*=c=1/c,s*=c,u*=c,n=Math.sin(e),i=1-(a=Math.cos(e)),t[0]=o*o*i+a,t[1]=s*o*i+u*n,t[2]=u*o*i-s*n,t[3]=0,t[4]=o*s*i-u*n,t[5]=s*s*i+a,t[6]=u*s*i+o*n,t[7]=0,t[8]=o*u*i+s*n,t[9]=s*u*i-o*n,t[10]=u*u*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Me(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=n+n,u=a+a,c=i+i,h=n*s,l=n*u,f=n*c,m=a*u,d=a*c,p=i*c,v=o*s,M=o*u,g=o*c;return t[0]=1-(m+p),t[1]=l+g,t[2]=f-M,t[3]=0,t[4]=l-g,t[5]=1-(h+p),t[6]=d+v,t[7]=0,t[8]=f+M,t[9]=d-v,t[10]=1-(h+m),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function be(t,e){var r=new d(3),n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=n*n+a*a+i*i+o*o;return l>0?(r[0]=2*(s*o+h*n+u*i-c*a)/l,r[1]=2*(u*o+h*a+c*n-s*i)/l,r[2]=2*(c*o+h*i+s*a-u*n)/l):(r[0]=2*(s*o+h*n+u*i-c*a),r[1]=2*(u*o+h*a+c*n-s*i),r[2]=2*(c*o+h*i+s*a-u*n)),ge(t,e,r),t}function ye(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function we(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],o=e[5],s=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(i,o,s),t[2]=Math.hypot(u,c,h),t}function xe(t,e){var r=new d(3);we(r,e);var n=1/r[0],a=1/r[1],i=1/r[2],o=e[0]*n,s=e[1]*a,u=e[2]*i,c=e[4]*n,h=e[5]*a,l=e[6]*i,f=e[8]*n,m=e[9]*a,p=e[10]*i,v=o+h+p,M=0;return v>0?(M=2*Math.sqrt(v+1),t[3]=.25*M,t[0]=(l-m)/M,t[1]=(f-u)/M,t[2]=(s-c)/M):o>h&&o>p?(M=2*Math.sqrt(1+o-h-p),t[3]=(l-m)/M,t[0]=.25*M,t[1]=(s+c)/M,t[2]=(f+u)/M):h>p?(M=2*Math.sqrt(1+h-o-p),t[3]=(f-u)/M,t[0]=(s+c)/M,t[1]=.25*M,t[2]=(l+m)/M):(M=2*Math.sqrt(1+p-o-h),t[3]=(s-c)/M,t[0]=(f+u)/M,t[1]=(l+m)/M,t[2]=.25*M),t}function Se(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3],u=a+a,c=i+i,h=o+o,l=a*u,f=a*c,m=a*h,d=i*c,p=i*h,v=o*h,M=s*u,g=s*c,b=s*h,y=n[0],w=n[1],x=n[2];return t[0]=(1-(d+v))*y,t[1]=(f+b)*y,t[2]=(m-g)*y,t[3]=0,t[4]=(f-b)*w,t[5]=(1-(l+v))*w,t[6]=(p+M)*w,t[7]=0,t[8]=(m+g)*x,t[9]=(p-M)*x,t[10]=(1-(l+d))*x,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function _e(t,e,r,n,a){var i=e[0],o=e[1],s=e[2],u=e[3],c=i+i,h=o+o,l=s+s,f=i*c,m=i*h,d=i*l,p=o*h,v=o*l,M=s*l,g=u*c,b=u*h,y=u*l,w=n[0],x=n[1],S=n[2],_=a[0],A=a[1],F=a[2],P=(1-(p+M))*w,E=(m+y)*w,B=(d-b)*w,O=(m-y)*x,T=(1-(f+M))*x,R=(v+g)*x,q=(d+b)*S,C=(v-g)*S,I=(1-(f+p))*S;return t[0]=P,t[1]=E,t[2]=B,t[3]=0,t[4]=O,t[5]=T,t[6]=R,t[7]=0,t[8]=q,t[9]=C,t[10]=I,t[11]=0,t[12]=r[0]+_-(P*_+O*A+q*F),t[13]=r[1]+A-(E*_+T*A+C*F),t[14]=r[2]+F-(B*_+R*A+I*F),t[15]=1,t}function Ae(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,c=r*o,h=n*o,l=n*s,f=a*o,m=a*s,d=a*u,p=i*o,v=i*s,M=i*u;return t[0]=1-l-d,t[1]=h+M,t[2]=f-v,t[3]=0,t[4]=h-M,t[5]=1-c-d,t[6]=m+p,t[7]=0,t[8]=f+v,t[9]=m-p,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Fe(t,e,r,n,a,i,o){var s=1/(r-e),u=1/(a-n),c=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+n)*u,t[10]=(o+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*c,t[15]=0,t}function Pe(t,e,r,n,a){var i,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(i=1/(n-a),t[10]=(a+n)*i,t[14]=2*a*n*i):(t[10]=-1,t[14]=-2*n),t}var Ee=Pe;function Be(t,e,r,n,a){var i,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(i=1/(n-a),t[10]=a*i,t[14]=a*n*i):(t[10]=-1,t[14]=-n),t}function Oe(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(a-i)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Te(t,e,r,n,a,i,o){var s=1/(e-r),u=1/(n-a),c=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*u,t[14]=(o+i)*c,t[15]=1,t}var Re=Te;function qe(t,e,r,n,a,i,o){var s=1/(e-r),u=1/(n-a),c=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*u,t[14]=i*c,t[15]=1,t}function Ce(t,e,r,n){var a,i,o,s,u,c,h,l,f,d,p=e[0],v=e[1],M=e[2],g=n[0],b=n[1],y=n[2],w=r[0],x=r[1],S=r[2];return Math.abs(p-w)<m&&Math.abs(v-x)<m&&Math.abs(M-S)<m?te(t):(h=p-w,l=v-x,f=M-S,a=b*(f*=d=1/Math.hypot(h,l,f))-y*(l*=d),i=y*(h*=d)-g*f,o=g*l-b*h,(d=Math.hypot(a,i,o))?(a*=d=1/d,i*=d,o*=d):(a=0,i=0,o=0),s=l*o-f*i,u=f*a-h*o,c=h*i-l*a,(d=Math.hypot(s,u,c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),t[0]=a,t[1]=s,t[2]=h,t[3]=0,t[4]=i,t[5]=u,t[6]=l,t[7]=0,t[8]=o,t[9]=c,t[10]=f,t[11]=0,t[12]=-(a*p+i*v+o*M),t[13]=-(s*p+u*v+c*M),t[14]=-(h*p+l*v+f*M),t[15]=1,t)}function Ie(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=n[0],u=n[1],c=n[2],h=a-r[0],l=i-r[1],f=o-r[2],m=h*h+l*l+f*f;m>0&&(h*=m=1/Math.sqrt(m),l*=m,f*=m);var d=u*f-c*l,p=c*h-s*f,v=s*l-u*h;return(m=d*d+p*p+v*v)>0&&(d*=m=1/Math.sqrt(m),p*=m,v*=m),t[0]=d,t[1]=p,t[2]=v,t[3]=0,t[4]=l*v-f*p,t[5]=f*d-h*v,t[6]=h*p-l*d,t[7]=0,t[8]=h,t[9]=l,t[10]=f,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t}function je(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function De(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ze(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Le(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Ue(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Ge(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function ke(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Ve(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],d=t[11],p=t[12],v=t[13],M=t[14],g=t[15],b=e[0],y=e[1],w=e[2],x=e[3],S=e[4],_=e[5],A=e[6],F=e[7],P=e[8],E=e[9],B=e[10],O=e[11],T=e[12],R=e[13],q=e[14],C=e[15];return Math.abs(r-b)<=m*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-y)<=m*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(a-w)<=m*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(i-x)<=m*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-S)<=m*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-_)<=m*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(u-A)<=m*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(c-F)<=m*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(h-P)<=m*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(l-E)<=m*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(f-B)<=m*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(d-O)<=m*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(p-T)<=m*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(v-R)<=m*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(M-q)<=m*Math.max(1,Math.abs(M),Math.abs(q))&&Math.abs(g-C)<=m*Math.max(1,Math.abs(g),Math.abs(C))}var Ne=ie,Xe=Le;function Ye(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function $e(t){var e=new d(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ze(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Ke(t,e,r){var n=new d(3);return n[0]=t,n[1]=e,n[2]=r,n}function Qe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function We(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function He(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Je(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function tr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function er(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function rr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function nr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function ar(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function ir(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function or(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function sr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ur(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function cr(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.hypot(r,n,a)}function hr(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a}function lr(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function fr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function mr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function dr(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function pr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function vr(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2];return t[0]=a*u-i*s,t[1]=i*o-n*u,t[2]=n*s-a*o,t}function Mr(t,e,r,n){var a=e[0],i=e[1],o=e[2];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t}function gr(t,e,r,n,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,c=o*(i-1),h=o*(3-2*i);return t[0]=e[0]*s+r[0]*u+n[0]*c+a[0]*h,t[1]=e[1]*s+r[1]*u+n[1]*c+a[1]*h,t[2]=e[2]*s+r[2]*u+n[2]*c+a[2]*h,t}function br(t,e,r,n,a,i){var o=1-i,s=o*o,u=i*i,c=s*o,h=3*i*s,l=3*u*o,f=u*i;return t[0]=e[0]*c+r[0]*h+n[0]*l+a[0]*f,t[1]=e[1]*c+r[1]*h+n[1]*l+a[1]*f,t[2]=e[2]*c+r[2]*h+n[2]*l+a[2]*f,t}function yr(t,e){e=e||1;var r=2*p()*Math.PI,n=2*p()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t}function wr(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o,t}function xr(t,e,r){var n=e[0],a=e[1],i=e[2];return t[0]=n*r[0]+a*r[3]+i*r[6],t[1]=n*r[1]+a*r[4]+i*r[7],t[2]=n*r[2]+a*r[5]+i*r[8],t}function Sr(t,e,r){var n=r[0],a=r[1],i=r[2],o=r[3],s=e[0],u=e[1],c=e[2],h=a*c-i*u,l=i*s-n*c,f=n*u-a*s,m=a*f-i*l,d=i*h-n*f,p=n*l-a*h,v=2*o;return h*=v,l*=v,f*=v,m*=2,d*=2,p*=2,t[0]=s+h+m,t[1]=u+l+d,t[2]=c+f+p,t}function _r(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Ar(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Fr(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function Pr(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],o=e[1],s=e[2],u=Math.sqrt(r*r+n*n+a*a)*Math.sqrt(i*i+o*o+s*s),c=u&&pr(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Er(t){return t[0]=0,t[1]=0,t[2]=0,t}function Br(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Or(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Tr(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],o=e[1],s=e[2];return Math.abs(r-i)<=m*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=m*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-s)<=m*Math.max(1,Math.abs(a),Math.abs(s))}var Rr,qr=Je,Cr=tr,Ir=er,jr=cr,Dr=hr,zr=Ze,Lr=lr,Ur=(Rr=Ye(),function(t,e,r,n,a,i){var o,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)Rr[0]=t[o],Rr[1]=t[o+1],Rr[2]=t[o+2],a(Rr,Rr,i),t[o]=Rr[0],t[o+1]=Rr[1],t[o+2]=Rr[2];return t});function Gr(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function kr(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Vr(t,e,r,n){var a=new d(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function Nr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Xr(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t}function Yr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function $r(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Zr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Kr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Qr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Wr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Hr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Jr(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function tn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function en(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function rn(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function nn(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.hypot(r,n,a,i)}function an(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return r*r+n*n+a*a+i*i}function on(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.hypot(e,r,n,a)}function sn(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a}function un(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function cn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function hn(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=a*o,t[3]=i*o,t}function ln(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function fn(t,e,r,n){var a=r[0]*n[1]-r[1]*n[0],i=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=e[0],l=e[1],f=e[2],m=e[3];return t[0]=l*c-f*u+m*s,t[1]=-h*c+f*o-m*i,t[2]=h*u-l*o+m*a,t[3]=-h*s+l*i-f*a,t}function mn(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t}function dn(t,e){var r,n,a,i,o,s;e=e||1;do{o=(r=2*p()-1)*r+(n=2*p()-1)*n}while(o>=1);do{s=(a=2*p()-1)*a+(i=2*p()-1)*i}while(s>=1);var u=Math.sqrt((1-o)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*a*u,t[3]=e*i*u,t}function pn(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,t}function vn(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*i-u*a,l=c*a+u*n-o*i,f=c*i+o*a-s*n,m=-o*n-s*a-u*i;return t[0]=h*c+m*-o+l*-u-f*-s,t[1]=l*c+m*-s+f*-o-h*-u,t[2]=f*c+m*-u+h*-s-l*-o,t[3]=e[3],t}function Mn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function gn(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function bn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function yn(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=m*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=m*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=m*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=m*Math.max(1,Math.abs(i),Math.abs(c))}var wn=$r,xn=Zr,Sn=Kr,_n=nn,An=an,Fn=on,Pn=sn,En=function(){var t=Gr();return function(e,r,n,a,i,o){var s,u;for(r||(r=4),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Bn(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function On(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Tn(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Rn(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>m?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function qn(t,e){var r=ua(t,e);return Math.acos(2*r*r-1)}function Cn(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],c=r[2],h=r[3];return t[0]=n*h+o*s+a*c-i*u,t[1]=a*h+o*u+i*s-n*c,t[2]=i*h+o*c+n*u-a*s,t[3]=o*h-n*s-a*u-i*c,t}function In(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=a*u+i*s,t[2]=i*u-a*s,t[3]=o*u-n*s,t}function jn(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-i*s,t[1]=a*u+o*s,t[2]=i*u+n*s,t[3]=o*u-a*s,t}function Dn(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=a*u-n*s,t[2]=i*u+o*s,t[3]=o*u-i*s,t}function zn(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t}function Ln(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=Math.sqrt(r*r+n*n+a*a),s=Math.exp(i),u=o>0?s*Math.sin(o)/o:0;return t[0]=r*u,t[1]=n*u,t[2]=a*u,t[3]=s*Math.cos(o),t}function Un(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=Math.sqrt(r*r+n*n+a*a),s=o>0?Math.atan2(o,i)/o:0;return t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=.5*Math.log(r*r+n*n+a*a+i*i),t}function Gn(t,e,r){return Un(t,e),sa(t,t,r),Ln(t,t),t}function kn(t,e,r,n){var a,i,o,s,u,c=e[0],h=e[1],l=e[2],f=e[3],d=r[0],p=r[1],v=r[2],M=r[3];return(i=c*d+h*p+l*v+f*M)<0&&(i=-i,d=-d,p=-p,v=-v,M=-M),1-i>m?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-n)*a)/o,u=Math.sin(n*a)/o):(s=1-n,u=n),t[0]=s*c+u*d,t[1]=s*h+u*p,t[2]=s*l+u*v,t[3]=s*f+u*M,t}function Vn(t){var e=p(),r=p(),n=p(),a=Math.sqrt(1-e),i=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*r),t[1]=a*Math.cos(2*Math.PI*r),t[2]=i*Math.sin(2*Math.PI*n),t[3]=i*Math.cos(2*Math.PI*n),t}function Nn(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-a*s,t[3]=i*s,t}function Xn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Yn(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+a]+e[3*a+i])*r,t[o]=(e[3*o+a]+e[3*a+o])*r}return t}function $n(t,e,r,n){var a=.5*Math.PI/180;e*=a,r*=a,n*=a;var i=Math.sin(e),o=Math.cos(e),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),h=Math.cos(n);return t[0]=i*u*h-o*s*c,t[1]=o*s*h+i*u*c,t[2]=o*u*c-i*s*h,t[3]=o*u*h+i*s*c,t}function Zn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Kn,Qn,Wn,Hn,Jn,ta,ea=kr,ra=Vr,na=Nr,aa=Xr,ia=Yr,oa=Cn,sa=en,ua=ln,ca=mn,ha=on,la=ha,fa=sn,ma=fa,da=hn,pa=bn,va=yn,Ma=(Kn=Ye(),Qn=Ke(1,0,0),Wn=Ke(0,1,0),function(t,e,r){var n=pr(e,r);return n<-.999999?(vr(Kn,Qn,e),zr(Kn)<1e-6&&vr(Kn,Wn,e),dr(Kn,Kn),Tn(t,Kn,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(vr(Kn,e,r),t[0]=Kn[0],t[1]=Kn[1],t[2]=Kn[2],t[3]=1+n,da(t,t))}),ga=(Hn=Bn(),Jn=Bn(),function(t,e,r,n,a,i){return kn(Hn,e,a,i),kn(Jn,r,n,i),kn(t,Hn,Jn,2*i*(1-i)),t}),ba=(ta=Mt(),function(t,e,r,n){return ta[0]=r[0],ta[3]=r[1],ta[6]=r[2],ta[1]=n[0],ta[4]=n[1],ta[7]=n[2],ta[2]=-e[0],ta[5]=-e[1],ta[8]=-e[2],da(t,Yn(t,ta))});function ya(){var t=new d(8);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function wa(t){var e=new d(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function xa(t,e,r,n,a,i,o,s){var u=new d(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=i,u[6]=o,u[7]=s,u}function Sa(t,e,r,n,a,i,o){var s=new d(8);s[0]=t,s[1]=e,s[2]=r,s[3]=n;var u=.5*a,c=.5*i,h=.5*o;return s[4]=u*n+c*r-h*e,s[5]=c*n+h*t-u*r,s[6]=h*n+u*e-c*t,s[7]=-u*t-c*e-h*r,s}function _a(t,e,r){var n=.5*r[0],a=.5*r[1],i=.5*r[2],o=e[0],s=e[1],u=e[2],c=e[3];return t[0]=o,t[1]=s,t[2]=u,t[3]=c,t[4]=n*c+a*u-i*s,t[5]=a*c+i*o-n*u,t[6]=i*c+n*s-a*o,t[7]=-n*o-a*s-i*u,t}function Aa(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function Fa(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Pa(t,e){var r=Bn();xe(r,e);var n=new d(3);return ye(n,e),_a(t,r,n),t}function Ea(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ba(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Oa(t,e,r,n,a,i,o,s,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t}var Ta=na;function Ra(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var qa=na;function Ca(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Ia(t,e){var r=e[4],n=e[5],a=e[6],i=e[7],o=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(r*c+i*o+n*u-a*s),t[1]=2*(n*c+i*s+a*o-r*u),t[2]=2*(a*c+i*u+r*s-n*o),t}function ja(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],h=e[4],l=e[5],f=e[6],m=e[7];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=o*s+a*c-i*u+h,t[5]=o*u+i*s-n*c+l,t[6]=o*c+n*u-a*s+f,t[7]=-n*s-a*u-i*c+m,t}function Da(t,e,r){var n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=s*o+h*n+u*i-c*a,f=u*o+h*a+c*n-s*i,m=c*o+h*i+s*a-u*n,d=h*o-s*n-u*a-c*i;return In(t,e,r),n=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+d*n+f*i-m*a,t[5]=f*o+d*a+m*n-l*i,t[6]=m*o+d*i+l*a-f*n,t[7]=d*o-l*n-f*a-m*i,t}function za(t,e,r){var n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=s*o+h*n+u*i-c*a,f=u*o+h*a+c*n-s*i,m=c*o+h*i+s*a-u*n,d=h*o-s*n-u*a-c*i;return jn(t,e,r),n=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+d*n+f*i-m*a,t[5]=f*o+d*a+m*n-l*i,t[6]=m*o+d*i+l*a-f*n,t[7]=d*o-l*n-f*a-m*i,t}function La(t,e,r){var n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=s*o+h*n+u*i-c*a,f=u*o+h*a+c*n-s*i,m=c*o+h*i+s*a-u*n,d=h*o-s*n-u*a-c*i;return Dn(t,e,r),n=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+d*n+f*i-m*a,t[5]=f*o+d*a+m*n-l*i,t[6]=m*o+d*i+l*a-f*n,t[7]=d*o-l*n-f*a-m*i,t}function Ua(t,e,r){var n=r[0],a=r[1],i=r[2],o=r[3],s=e[0],u=e[1],c=e[2],h=e[3];return t[0]=s*o+h*n+u*i-c*a,t[1]=u*o+h*a+c*n-s*i,t[2]=c*o+h*i+s*a-u*n,t[3]=h*o-s*n-u*a-c*i,s=e[4],u=e[5],c=e[6],h=e[7],t[4]=s*o+h*n+u*i-c*a,t[5]=u*o+h*a+c*n-s*i,t[6]=c*o+h*i+s*a-u*n,t[7]=h*o-s*n-u*a-c*i,t}function Ga(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],c=r[2],h=r[3];return t[0]=n*h+o*s+a*c-i*u,t[1]=a*h+o*u+i*s-n*c,t[2]=i*h+o*c+n*u-a*s,t[3]=o*h-n*s-a*u-i*c,s=r[4],u=r[5],c=r[6],h=r[7],t[4]=n*h+o*s+a*c-i*u,t[5]=a*h+o*u+i*s-n*c,t[6]=i*h+o*c+n*u-a*s,t[7]=o*h-n*s-a*u-i*c,t}function ka(t,e,r,n){if(Math.abs(n)<m)return Ea(t,e);var a=Math.hypot(r[0],r[1],r[2]);n*=.5;var i=Math.sin(n),o=i*r[0]/a,s=i*r[1]/a,u=i*r[2]/a,c=Math.cos(n),h=e[0],l=e[1],f=e[2],d=e[3];t[0]=h*c+d*o+l*u-f*s,t[1]=l*c+d*s+f*o-h*u,t[2]=f*c+d*u+h*s-l*o,t[3]=d*c-h*o-l*s-f*u;var p=e[4],v=e[5],M=e[6],g=e[7];return t[4]=p*c+g*o+v*u-M*s,t[5]=v*c+g*s+M*o-p*u,t[6]=M*c+g*u+p*s-v*o,t[7]=g*c-p*o-v*s-M*u,t}function Va(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function Na(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[4],u=r[5],c=r[6],h=r[7],l=e[4],f=e[5],m=e[6],d=e[7],p=r[0],v=r[1],M=r[2],g=r[3];return t[0]=n*g+o*p+a*M-i*v,t[1]=a*g+o*v+i*p-n*M,t[2]=i*g+o*M+n*v-a*p,t[3]=o*g-n*p-a*v-i*M,t[4]=n*h+o*s+a*c-i*u+l*g+d*p+f*M-m*v,t[5]=a*h+o*u+i*s-n*c+f*g+d*v+m*p-l*M,t[6]=i*h+o*c+n*u-a*s+m*g+d*M+l*v-f*p,t[7]=o*h-n*s-a*u-i*c+d*g-l*p-f*v-m*M,t}var Xa=Na;function Ya(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}var $a=ua;function Za(t,e,r,n){var a=1-n;return $a(e,r)<0&&(n=-n),t[0]=e[0]*a+r[0]*n,t[1]=e[1]*a+r[1]*n,t[2]=e[2]*a+r[2]*n,t[3]=e[3]*a+r[3]*n,t[4]=e[4]*a+r[4]*n,t[5]=e[5]*a+r[5]*n,t[6]=e[6]*a+r[6]*n,t[7]=e[7]*a+r[7]*n,t}function Ka(t,e){var r=Ja(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function Qa(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Wa=ha,Ha=Wa,Ja=fa,ti=Ja;function ei(t,e){var r=Ja(e);if(r>0){r=Math.sqrt(r);var n=e[0]/r,a=e[1]/r,i=e[2]/r,o=e[3]/r,s=e[4],u=e[5],c=e[6],h=e[7],l=n*s+a*u+i*c+o*h;t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=(s-n*l)/r,t[5]=(u-a*l)/r,t[6]=(c-i*l)/r,t[7]=(h-o*l)/r}return t}function ri(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function ni(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ai(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=e[0],l=e[1],f=e[2],d=e[3],p=e[4],v=e[5],M=e[6],g=e[7];return Math.abs(r-h)<=m*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-l)<=m*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-f)<=m*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-d)<=m*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=m*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-v)<=m*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-M)<=m*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-g)<=m*Math.max(1,Math.abs(c),Math.abs(g))}function ii(){var t=new d(2);return d!=Float32Array&&(t[0]=0,t[1]=0),t}function oi(t){var e=new d(2);return e[0]=t[0],e[1]=t[1],e}function si(t,e){var r=new d(2);return r[0]=t,r[1]=e,r}function ui(t,e){return t[0]=e[0],t[1]=e[1],t}function ci(t,e,r){return t[0]=e,t[1]=r,t}function hi(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function li(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function fi(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function mi(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function di(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function pi(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function vi(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function Mi(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function gi(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function bi(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function yi(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function wi(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function xi(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function Si(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function _i(t){var e=t[0],r=t[1];return e*e+r*r}function Ai(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Fi(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Pi(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t}function Ei(t,e){return t[0]*e[0]+t[1]*e[1]}function Bi(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function Oi(t,e,r,n){var a=e[0],i=e[1];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t}function Ti(t,e){e=e||1;var r=2*p()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function Ri(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t}function qi(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t}function Ci(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t}function Ii(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t}function ji(t,e,r,n){var a=e[0]-r[0],i=e[1]-r[1],o=Math.sin(n),s=Math.cos(n);return t[0]=a*s-i*o+r[0],t[1]=a*o+i*s+r[1],t}function Di(t,e){var r=t[0],n=t[1],a=e[0],i=e[1],o=Math.sqrt(r*r+n*n)*Math.sqrt(a*a+i*i),s=o&&(r*a+n*i)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function zi(t){return t[0]=0,t[1]=0,t}function Li(t){return"vec2("+t[0]+", "+t[1]+")"}function Ui(t,e){return t[0]===e[0]&&t[1]===e[1]}function Gi(t,e){var r=t[0],n=t[1],a=e[0],i=e[1];return Math.abs(r-a)<=m*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-i)<=m*Math.max(1,Math.abs(n),Math.abs(i))}var ki=Si,Vi=li,Ni=fi,Xi=mi,Yi=wi,$i=xi,Zi=_i,Ki=function(){var t=ii();return function(e,r,n,a,i,o){var s,u;for(r||(r=2),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],i(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}()},918:function(t,e,r){t.exports=function(t,e){"use strict";function r(t,e,r){if(r||2===arguments.length)for(var n,a=0,i=e.length;a<i;a++)!n&&a in e||(n||(n=Array.prototype.slice.call(e,0,a)),n[a]=e[a]);return t.concat(n||Array.prototype.slice.call(e))}var n=Object.freeze({__proto__:null,blackman:function(t){for(var e=new Float32Array(t),r=2*Math.PI/(t-1),n=2*r,a=0;a<t/2;a++)e[a]=.42-.5*Math.cos(a*r)+.08*Math.cos(a*n);for(a=Math.ceil(t/2);a>0;a--)e[t-a]=e[a-1];return e},hamming:function(t){for(var e=new Float32Array(t),r=0;r<t;r++)e[r]=.54-.46*Math.cos(2*Math.PI*(r/t-1));return e},hanning:function(t){for(var e=new Float32Array(t),r=0;r<t;r++)e[r]=.5-.5*Math.cos(2*Math.PI*r/(t-1));return e},sine:function(t){for(var e=Math.PI/(t-1),r=new Float32Array(t),n=0;n<t;n++)r[n]=Math.sin(e*n);return r}}),a={};function i(t){for(;t%2==0&&t>1;)t/=2;return 1===t}function o(t,e){if("rect"!==e){if(""!==e&&e||(e="hanning"),a[e]||(a[e]={}),!a[e][t.length])try{a[e][t.length]=n[e](t.length)}catch(t){throw new Error("Invalid windowing function")}t=function(t,e){for(var r=[],n=0;n<Math.min(t.length,e.length);n++)r[n]=t[n]*e[n];return r}(t,a[e][t.length])}return t}function s(t,e,r){for(var n=new Float32Array(t),a=0;a<n.length;a++)n[a]=a*e/r,n[a]=13*Math.atan(n[a]/1315.8)+3.5*Math.atan(Math.pow(n[a]/7518,2));return n}function u(t){return Float32Array.from(t)}function c(t){return 1125*Math.log(1+t/700)}function h(t,e,r){for(var n,a=new Float32Array(t+2),i=new Float32Array(t+2),o=e/2,s=c(0),u=(c(o)-s)/(t+1),h=new Array(t+2),l=0;l<a.length;l++)a[l]=l*u,i[l]=(n=a[l],700*(Math.exp(n/1125)-1)),h[l]=Math.floor((r+1)*i[l]/e);for(var f=new Array(t),m=0;m<f.length;m++){for(f[m]=new Array(r/2+1).fill(0),l=h[m];l<h[m+1];l++)f[m][l]=(l-h[m])/(h[m+1]-h[m]);for(l=h[m+1];l<h[m+2];l++)f[m][l]=(h[m+2]-l)/(h[m+2]-h[m+1])}return f}function l(t,e,n,a,i,o,s){void 0===a&&(a=5),void 0===i&&(i=2),void 0===o&&(o=!0),void 0===s&&(s=440);var u=Math.floor(n/2)+1,c=new Array(n).fill(0).map((function(r,a){return t*function(t,e){return Math.log2(16*t/e)}(e*a/n,s)}));c[0]=c[1]-1.5*t;var h,l,f,m=c.slice(1).map((function(t,e){return Math.max(t-c[e])}),1).concat([1]),d=Math.round(t/2),p=new Array(t).fill(0).map((function(e,r){return c.map((function(e){return(10*t+d+e-r)%t-d}))})),v=p.map((function(t,e){return t.map((function(t,r){return Math.exp(-.5*Math.pow(2*p[e][r]/m[r],2))}))}));if(l=(h=v)[0].map((function(){return 0})),f=h.reduce((function(t,e){return e.forEach((function(e,r){t[r]+=Math.pow(e,2)})),t}),l).map(Math.sqrt),v=h.map((function(t,e){return t.map((function(t,e){return t/(f[e]||1)}))})),i){var M=c.map((function(e){return Math.exp(-.5*Math.pow((e/t-a)/i,2))}));v=v.map((function(t){return t.map((function(t,e){return t*M[e]}))}))}return o&&(v=r(r([],v.slice(3),!0),v.slice(0,3),!0)),v.map((function(t){return t.slice(0,u)}))}function f(t,e){for(var r=0,n=0,a=0;a<e.length;a++)r+=Math.pow(a,t)*Math.abs(e[a]),n+=e[a];return r/n}function m(t){var e=t.ampSpectrum,r=t.barkScale,n=t.numberOfBarkBands,a=void 0===n?24:n;if("object"!=typeof e||"object"!=typeof r)throw new TypeError;var i=a,o=new Float32Array(i),s=0,u=e,c=new Int32Array(i+1);c[0]=0;for(var h=r[u.length-1]/i,l=1,f=0;f<u.length;f++)for(;r[f]>h;)c[l++]=f,h=l*r[u.length-1]/i;for(c[i]=u.length-1,f=0;f<i;f++){for(var m=0,d=c[f];d<c[f+1];d++)m+=u[d];o[f]=Math.pow(m,.23)}for(f=0;f<o.length;f++)s+=o[f];return{specific:o,total:s}}function d(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;for(var r=new Float32Array(e.length),n=0;n<r.length;n++)r[n]=Math.pow(e[n],2);return r}function p(t){var e=t.ampSpectrum,r=t.melFilterBank,n=t.bufferSize;if("object"!=typeof e)throw new TypeError("Valid ampSpectrum is required to generate melBands");if("object"!=typeof r)throw new TypeError("Valid melFilterBank is required to generate melBands");for(var a=d({ampSpectrum:e}),i=r.length,o=Array(i),s=new Float32Array(i),u=0;u<s.length;u++){o[u]=new Float32Array(n/2),s[u]=0;for(var c=0;c<n/2;c++)o[u][c]=r[u][c]*a[c],s[u]+=o[u][c];s[u]=Math.log(s[u]+1)}return Array.prototype.slice.call(s)}var v=Object.freeze({__proto__:null,amplitudeSpectrum:function(t){return t.ampSpectrum},buffer:function(t){return t.signal},chroma:function(t){var e=t.ampSpectrum,r=t.chromaFilterBank;if("object"!=typeof e)throw new TypeError("Valid ampSpectrum is required to generate chroma");if("object"!=typeof r)throw new TypeError("Valid chromaFilterBank is required to generate chroma");var n=r.map((function(t,r){return e.reduce((function(e,r,n){return e+r*t[n]}),0)})),a=Math.max.apply(Math,n);return a?n.map((function(t){return t/a})):n},complexSpectrum:function(t){return t.complexSpectrum},energy:function(t){var e=t.signal;if("object"!=typeof e)throw new TypeError;for(var r=0,n=0;n<e.length;n++)r+=Math.pow(Math.abs(e[n]),2);return r},loudness:m,melBands:p,mfcc:function(e){var r=e.ampSpectrum,n=e.melFilterBank,a=e.numberOfMFCCCoefficients,i=e.bufferSize,o=Math.min(40,Math.max(1,a||13));if(n.length<o)throw new Error("Insufficient filter bank for requested number of coefficients");var s=p({ampSpectrum:r,melFilterBank:n,bufferSize:i});return t(s).slice(0,o)},perceptualSharpness:function(t){for(var e=m({ampSpectrum:t.ampSpectrum,barkScale:t.barkScale}),r=e.specific,n=0,a=0;a<r.length;a++)n+=a<15?(a+1)*r[a+1]:.066*Math.exp(.171*(a+1));return n*(.11/e.total)},perceptualSpread:function(t){for(var e=m({ampSpectrum:t.ampSpectrum,barkScale:t.barkScale}),r=0,n=0;n<e.specific.length;n++)e.specific[n]>r&&(r=e.specific[n]);return Math.pow((e.total-r)/e.total,2)},powerSpectrum:d,rms:function(t){var e=t.signal;if("object"!=typeof e)throw new TypeError;for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n],2);return r/=e.length,Math.sqrt(r)},spectralCentroid:function(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;return f(1,e)},spectralCrest:function(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;var r=0,n=-1/0;return e.forEach((function(t){r+=Math.pow(t,2),n=t>n?t:n})),r/=e.length,r=Math.sqrt(r),n/r},spectralFlatness:function(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;for(var r=0,n=0,a=0;a<e.length;a++)r+=Math.log(e[a]),n+=e[a];return Math.exp(r/e.length)*e.length/n},spectralFlux:function(t){var e=t.signal,r=t.previousSignal,n=t.bufferSize;if("object"!=typeof e||"object"!=typeof r)throw new TypeError;for(var a=0,i=-n/2;i<e.length/2-1;i++)x=Math.abs(e[i])-Math.abs(r[i]),a+=(x+Math.abs(x))/2;return a},spectralKurtosis:function(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;var r=e,n=f(1,r),a=f(2,r),i=f(3,r),o=f(4,r);return(-3*Math.pow(n,4)+6*n*a-4*n*i+o)/Math.pow(Math.sqrt(a-Math.pow(n,2)),4)},spectralRolloff:function(t){var e=t.ampSpectrum,r=t.sampleRate;if("object"!=typeof e)throw new TypeError;for(var n=e,a=r/(2*(n.length-1)),i=0,o=0;o<n.length;o++)i+=n[o];for(var s=.99*i,u=n.length-1;i>s&&u>=0;)i-=n[u],--u;return(u+1)*a},spectralSkewness:function(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;var r=f(1,e),n=f(2,e),a=f(3,e);return(2*Math.pow(r,3)-3*r*n+a)/Math.pow(Math.sqrt(n-Math.pow(r,2)),3)},spectralSlope:function(t){var e=t.ampSpectrum,r=t.sampleRate,n=t.bufferSize;if("object"!=typeof e)throw new TypeError;for(var a=0,i=0,o=new Float32Array(e.length),s=0,u=0,c=0;c<e.length;c++){a+=e[c];var h=c*r/n;o[c]=h,s+=h*h,i+=h,u+=h*e[c]}return(e.length*u-i*a)/(a*(s-Math.pow(i,2)))},spectralSpread:function(t){var e=t.ampSpectrum;if("object"!=typeof e)throw new TypeError;return Math.sqrt(f(2,e)-Math.pow(f(1,e),2))},zcr:function(t){var e=t.signal;if("object"!=typeof e)throw new TypeError;for(var r=0,n=1;n<e.length;n++)(e[n-1]>=0&&e[n]<0||e[n-1]<0&&e[n]>=0)&&r++;return r}}),M=function(){function t(t,e){var r=this;if(this._m=e,!t.audioContext)throw this._m.errors.noAC;if(t.bufferSize&&!i(t.bufferSize))throw this._m._errors.notPow2;if(!t.source)throw this._m._errors.noSource;this._m.audioContext=t.audioContext,this._m.bufferSize=t.bufferSize||this._m.bufferSize||256,this._m.hopSize=t.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=t.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=t.callback,this._m.windowingFunction=t.windowingFunction||"hanning",this._m.featureExtractors=v,this._m.EXTRACTION_STARTED=t.startImmediately||!1,this._m.channel="number"==typeof t.channel?t.channel:0,this._m.inputs=t.inputs||1,this._m.outputs=t.outputs||1,this._m.numberOfMFCCCoefficients=t.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.numberOfBarkBands=t.numberOfBarkBands||this._m.numberOfBarkBands||24,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=t.featureExtractors||[],this._m.barkScale=s(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=h(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(t.source),this._m.spn.onaudioprocess=function(t){var e;null!==r._m.inputData&&(r._m.previousInputData=r._m.inputData),r._m.inputData=t.inputBuffer.getChannelData(r._m.channel),r._m.previousInputData?((e=new Float32Array(r._m.previousInputData.length+r._m.inputData.length-r._m.hopSize)).set(r._m.previousInputData.slice(r._m.hopSize)),e.set(r._m.inputData,r._m.previousInputData.length-r._m.hopSize)):e=r._m.inputData;var n=function(t,e,r){if(t.length<e)throw new Error("Buffer is too short for frame length");if(r<1)throw new Error("Hop length cannot be less that 1");if(e<1)throw new Error("Frame length cannot be less that 1");var n=1+Math.floor((t.length-e)/r);return new Array(n).fill(0).map((function(n,a){return t.slice(a*r,a*r+e)}))}(e,r._m.bufferSize,r._m.hopSize);n.forEach((function(t){r._m.frame=t;var e=r._m.extract(r._m._featuresToExtract,r._m.frame,r._m.previousFrame);"function"==typeof r._m.callback&&r._m.EXTRACTION_STARTED&&r._m.callback(e),r._m.previousFrame=r._m.frame}))}}return t.prototype.start=function(t){this._m._featuresToExtract=t||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},t.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},t.prototype.setSource=function(t){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=t,this._m.source.connect(this._m.spn)},t.prototype.setChannel=function(t){t<=this._m.inputs?this._m.channel=t:console.error("Channel ".concat(t," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(t," when instantiating the MeydaAnalyzer"))},t.prototype.get=function(t){return this._m.inputData?this._m.extract(t||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},t}(),g={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:v,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,numberOfBarkBands:24,_featuresToExtract:[],windowing:o,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(t){return new M(t,Object.assign({},g))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(t,e,r){var n=this;if(!e)throw this._errors.invalidInput;if("object"!=typeof e)throw this._errors.invalidInput;if(!t)throw this._errors.featureUndef;if(!i(e.length))throw this._errors.notPow2;void 0!==this.barkScale&&this.barkScale.length==this.bufferSize||(this.barkScale=s(this.bufferSize,this.sampleRate,this.bufferSize)),void 0!==this.melFilterBank&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=h(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),void 0!==this.chromaFilterBank&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=l(this.chromaBands,this.sampleRate,this.bufferSize)),"buffer"in e&&void 0===e.buffer?this.signal=u(e):this.signal=e;var a=b(e,this.windowingFunction,this.bufferSize);if(this.signal=a.windowedSignal,this.complexSpectrum=a.complexSpectrum,this.ampSpectrum=a.ampSpectrum,r){var o=b(r,this.windowingFunction,this.bufferSize);this.previousSignal=o.windowedSignal,this.previousComplexSpectrum=o.complexSpectrum,this.previousAmpSpectrum=o.ampSpectrum}var c=function(t){return n.featureExtractors[t]({ampSpectrum:n.ampSpectrum,chromaFilterBank:n.chromaFilterBank,complexSpectrum:n.complexSpectrum,signal:n.signal,bufferSize:n.bufferSize,sampleRate:n.sampleRate,barkScale:n.barkScale,melFilterBank:n.melFilterBank,previousSignal:n.previousSignal,previousAmpSpectrum:n.previousAmpSpectrum,previousComplexSpectrum:n.previousComplexSpectrum,numberOfMFCCCoefficients:n.numberOfMFCCCoefficients,numberOfBarkBands:n.numberOfBarkBands})};if("object"==typeof t)return t.reduce((function(t,e){var r;return Object.assign({},t,((r={})[e]=c(e),r))}),{});if("string"==typeof t)return c(t);throw this._errors.invalidFeatureFmt}},b=function(t,r,n){var a={};void 0===t.buffer?a.signal=u(t):a.signal=t,a.windowedSignal=o(a.signal,r),a.complexSpectrum=e.fft(a.windowedSignal),a.ampSpectrum=new Float32Array(n/2);for(var i=0;i<n/2;i++)a.ampSpectrum[i]=Math.sqrt(Math.pow(a.complexSpectrum.real[i],2)+Math.pow(a.complexSpectrum.imag[i],2));return a};return"undefined"!=typeof window&&(window.Meyda=g),g}(r(91),r(196))},285:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=a(r(918));e.default=class{constructor(t,e,r){this.chunkLength=t,this.sampleRate=e,this.audioSampleSize=r,this.input=document.querySelector("input"),this.audioContext=new AudioContext}analyse(){return n(this,void 0,void 0,(function*(){const t=[];return yield fetch(URL.createObjectURL(this.input.files[0])).then((t=>{const e=document.getElementById("soundPlayer");return e.src=t.url,e.play(),t.arrayBuffer()})).then((t=>new OfflineAudioContext({length:1,sampleRate:this.sampleRate}).decodeAudioData(t))).then((e=>{const r=this.audioSampleSize,n=new Float32Array(r),a=Math.ceil(r/this.chunkLength);for(let o=0;o<e.length;o+=r){e.copyFromChannel(n,0,o);const r=i.default.extract("amplitudeSpectrum",n);if(null==r||0===r.length)continue;let s=0;const u=r.length;for(;s<u;){let e=r.slice(s,s+=a).reduce((function(t,e){return Math.max(t,Math.abs(e))}));t.push(e)}}})),t}))}}},201:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(e,r);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,a)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});const o=r(659),s=i(r(70));e.default=class{constructor(){this.viewMatrix=o.mat4.create(),this.projectionMatrix=o.mat4.create(),this.position=o.vec3.create(),this.rotation=o.vec3.create(),this.maxDistance=20}static getInstance(){return this.instance||(this.instance=new this)}initialize(){this.position=o.vec3.fromValues(0,0,-10),this.rotation=o.vec3.fromValues(0,0,0),this.updateProjectionMatrix(),this.updateViewMatrix()}getPosition(){return this.position}getProjectionMatrix(){return this.projectionMatrix}getViewMatrix(){return this.viewMatrix}updateProjectionMatrix(){o.mat4.identity(this.projectionMatrix),o.mat4.perspective(this.projectionMatrix,s.default.fovRadian,s.canvasSize/s.canvasSize,s.default.near,s.default.far)}updateViewMatrix(){o.mat4.identity(this.viewMatrix),o.mat4.translate(this.viewMatrix,this.viewMatrix,this.position),o.mat4.rotateX(this.viewMatrix,this.viewMatrix,this.rotation[0]),o.mat4.rotateY(this.viewMatrix,this.viewMatrix,this.rotation[1]),o.mat4.rotateZ(this.viewMatrix,this.viewMatrix,this.rotation[2])}setPosition(t){this.position=t,this.updateViewMatrix()}setRotation(t){this.rotation=t,this.updateViewMatrix()}moveForward(t){const e=o.vec3.create();o.vec3.set(e,0,0,t),o.vec3.add(this.position,this.position,this.rotateVector(e)),this.clampPosition(this.position),this.updateViewMatrix()}moveRight(t){const e=o.vec3.create();o.vec3.set(e,t,0,0),o.vec3.add(this.position,this.position,this.rotateVector(e)),this.clampPosition(this.position),this.updateViewMatrix()}moveUp(t){const e=o.vec3.create();o.vec3.set(e,0,t,0),o.vec3.add(this.position,this.position,this.rotateVector(e)),this.clampPosition(this.position),this.updateViewMatrix()}rotateVector(t){const e=o.glMatrix.toRadian;return o.vec3.rotateX(t,t,[0,0,0],e(this.rotation[0])),o.vec3.rotateY(t,t,[0,0,0],e(this.rotation[1])),o.vec3.rotateZ(t,t,[0,0,0],e(this.rotation[2])),t}clampPosition(t){return t[0]=Math.min(t[0],this.maxDistance),t[0]=Math.max(t[0],-this.maxDistance),t[1]=Math.min(t[1],this.maxDistance),t[1]=Math.max(t[1],-this.maxDistance),t[2]=Math.min(t[2],this.maxDistance),t[2]=Math.max(t[2],-this.maxDistance),t}rotateXY(t,e){this.rotation[0]+=t,this.rotation[1]+=e,this.updateViewMatrix()}}},127:function(t,e){"use strict";var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.selectedImageIndex=0,this.imageSources=[["../assets/img/cubemap/base/posx.jpg","../assets/img/cubemap/base/negx.jpg","../assets/img/cubemap/base/posy.jpg","../assets/img/cubemap/base/negy.jpg","../assets/img/cubemap/base/posz.jpg","../assets/img/cubemap/base/negz.jpg"],["../assets/img/cubemap/spaceblue/posx.png","../assets/img/cubemap/spaceblue/negx.png","../assets/img/cubemap/spaceblue/posy.png","../assets/img/cubemap/spaceblue/negy.png","../assets/img/cubemap/spaceblue/posz.png","../assets/img/cubemap/spaceblue/negz.png"],["../assets/img/cubemap/solid/white.png","../assets/img/cubemap/solid/white.png","../assets/img/cubemap/solid/white.png","../assets/img/cubemap/solid/white.png","../assets/img/cubemap/solid/white.png","../assets/img/cubemap/solid/white.png"],["../assets/img/cubemap/solid/gray.png","../assets/img/cubemap/solid/gray.png","../assets/img/cubemap/solid/gray.png","../assets/img/cubemap/solid/gray.png","../assets/img/cubemap/solid/gray.png","../assets/img/cubemap/solid/gray.png"]]}static getInstance(){return this.instance||(this.instance=new this)}changeCubeMap(t,e){t=t<0?this.imageSources.length+t:t,t%=this.imageSources.length,this.selectedImageIndex=t,this.loadCubeMap(e).then((()=>{console.log("CubeMap Changed")}))}loadCubeMap(t){return r(this,void 0,void 0,(function*(){const e=this.imageSources[this.selectedImageIndex].map((t=>r(this,void 0,void 0,(function*(){const e=yield fetch(t);return createImageBitmap(yield e.blob())})))),n=yield Promise.all(e);this.cubeMapTexture=t.createTexture({dimension:"2d",size:[n[0].width,n[0].height,6],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});for(let e=0;e<n.length;e++){const r=n[e];t.queue.copyExternalImageToTexture({source:r},{texture:this.cubeMapTexture,origin:[0,0,e]},[r.width,r.height])}}))}getCubeMapTexture(){return this.cubeMapTexture}}},753:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(70),o=a(r(220)),s=a(r(923)),u=a(r(201)),c=a(r(285)),h=a(r(823)),l=a(r(465)),f=r(659),m=a(r(571));e.default=class{constructor(t){this.geoGen=new o.default,this.canvas=t,this.initCanvas(t),this.renderer=new s.default(t),this.audioAnalyser=new c.default(64,44100,512)}appRun(){return n(this,void 0,void 0,(function*(){(yield this.renderer.initializeAPI())&&(this.addInteractions(),this.renderer.resizeBackings(),u.default.getInstance().initialize(),u.default.getInstance().setPosition([0,0,-10]),this.renderer.setMesh(this.geoGen.makeBox(1)),yield this.renderer.setCubeMapMesh(this.geoGen.makeBox(40)),this.renderer.render(),h.default.getInstance().init(this.canvas,this.renderer.device))}))}initCanvas(t){t.width=t.height=i.canvasSize}analyseAudio(){return n(this,void 0,void 0,(function*(){const t=yield this.audioAnalyser.analyse();this.renderer.setMesh(this.geoGen.makeAudioMesh(t,5,64))}))}loadObjFile(t){return n(this,void 0,void 0,(function*(){const e=yield fetch(URL.createObjectURL(t.files[0]));if(!e.ok)throw new Error("Failed to load obj file");const r=yield e.text();this.renderer.setMesh(this.geoGen.makeObjMesh(r));let n=this.renderer.meshes[0];f.mat4.rotateX(n.transform,n.transform,Math.PI/2),n.rotType=1}))}addInteractions(){document.querySelector("#soundFileInput").addEventListener("input",(()=>{this.analyseAudio().then((()=>{console.log("Loaded audio file")}))}));const t=document.querySelector("#objFileInput");null==t||t.addEventListener("input",(()=>{this.loadObjFile(t).then((()=>{console.log("Loaded obj file")}))}));const e=document.querySelector("#objExportButton");null==e||e.addEventListener("click",(()=>{const t=l.default.exportMesh(this.renderer.meshes[0]),e=new Blob([t],{type:"text/plain;charset=utf-8"}),r=document.createElement("a");r.download="mesh.obj",r.href=URL.createObjectURL(e),r.click()}));const r=m.default.getInstance();for(let t=0;t<i.numOfLight;t++){const e=t+1,n=r.GetLight(t),a=document.querySelector(`#lightPositionRange${e}X`);a.value=""+(20*n.direction[0]+50),a.addEventListener("input",(()=>{n.direction[0]=(parseFloat(a.value)-50)/20}));const i=document.querySelector(`#lightPositionRange${e}Y`);i.value=""+(20*n.direction[1]+50),i.addEventListener("input",(()=>{n.direction[1]=(parseFloat(i.value)-50)/20}));const o=document.querySelector(`#lightPositionRange${e}Z`);o.value=""+(20*n.direction[2]+50),o.addEventListener("input",(()=>{n.direction[2]=(parseFloat(o.value)-50)/20}));const s=document.querySelector(`#lightColorRange${e}R`);s.value=""+100*n.color[0],s.addEventListener("input",(()=>{n.color[0]=parseFloat(s.value)/100}));const u=document.querySelector(`#lightColorRange${e}G`);u.value=""+100*n.color[1],u.addEventListener("input",(()=>{n.color[1]=parseFloat(u.value)/100}));const c=document.querySelector(`#lightColorRange${e}B`);c.value=""+100*n.color[2],c.addEventListener("input",(()=>{n.color[2]=parseFloat(c.value)/100}));const h=document.querySelector(`#lightColorIntensity${e}`);h.value=`${n.intensity} * 50`,h.addEventListener("input",(()=>{n.intensity=parseFloat(h.value)/50}))}const n=document.querySelector("#ambientRangeR");n.value=""+100*r.GetMaterial().ambient[0],n.addEventListener("input",(()=>{r.GetMaterial().ambient[0]=parseFloat(n.value)/100}));const a=document.querySelector("#ambientRangeG");a.value=""+100*r.GetMaterial().ambient[1],a.addEventListener("input",(()=>{r.GetMaterial().ambient[1]=parseFloat(a.value)/100}));const o=document.querySelector("#ambientRangeB");o.value=""+100*r.GetMaterial().ambient[2],o.addEventListener("input",(()=>{r.GetMaterial().ambient[2]=parseFloat(o.value)/100}));const s=document.querySelector("#diffuseRangeR");s.value=""+100*r.GetMaterial().diffuse[0],s.addEventListener("input",(()=>{r.GetMaterial().diffuse[0]=parseFloat(s.value)/100}));const u=document.querySelector("#diffuseRangeG");u.value=""+100*r.GetMaterial().diffuse[1],u.addEventListener("input",(()=>{r.GetMaterial().diffuse[1]=parseFloat(u.value)/100}));const c=document.querySelector("#diffuseRangeB");c.value=""+100*r.GetMaterial().diffuse[2],c.addEventListener("input",(()=>{r.GetMaterial().diffuse[2]=parseFloat(c.value)/100}));const h=document.querySelector("#specularRangeR");h.value=""+100*r.GetMaterial().specular[0],h.addEventListener("input",(()=>{r.GetMaterial().specular[0]=parseFloat(h.value)/100}));const f=document.querySelector("#specularRangeG");f.value=""+100*r.GetMaterial().specular[1],f.addEventListener("input",(()=>{r.GetMaterial().specular[1]=parseFloat(f.value)/100}));const d=document.querySelector("#specularRangeB");d.value=""+100*r.GetMaterial().specular[2],d.addEventListener("input",(()=>{r.GetMaterial().specular[2]=parseFloat(d.value)/100}));const p=document.querySelector("#shininessRange");p.value=`${r.GetMaterial().shininess}`,p.addEventListener("input",(()=>{r.GetMaterial().shininess=parseFloat(p.value)}))}}},823:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(201)),i=n(r(127));class o{constructor(){this.isOnDrag=!1}static getInstance(){return this.instance||(this.instance=new this)}init(t,e){t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp),t.addEventListener("wheel",this.onWheel),this.device=e}onMouseMove(t){this.isOnDrag&&a.default.getInstance().rotateXY(t.movementY/100,t.movementX/100)}onMouseDown(t){0===t.button&&(this.isOnDrag=!0)}onMouseUp(t){0===t.button&&(this.isOnDrag=!1)}onKeyDown(t){"`"===t.key&&a.default.getInstance().initialize();const e=o.getInstance();e.processMoveKey(t),e.processNumberKey(t)}onKeyUp(t){}onWheel(t){a.default.getInstance().moveForward(t.deltaY/100)}processMoveKey(t){"w"==t.key&&a.default.getInstance().moveForward(.3),"s"==t.key&&a.default.getInstance().moveForward(-.3),"a"==t.key&&a.default.getInstance().moveRight(.3),"d"==t.key&&a.default.getInstance().moveRight(-.3),"q"==t.key&&a.default.getInstance().moveUp(-.3),"e"==t.key&&a.default.getInstance().moveUp(.3)}processNumberKey(t){const e=parseInt(t.key);if(!(e<0||e>9))switch(e){case 1:null!=this.device&&i.default.getInstance().changeCubeMap(0,this.device);break;case 2:null!=this.device&&i.default.getInstance().changeCubeMap(1,this.device);break;case 3:null!=this.device&&i.default.getInstance().changeCubeMap(2,this.device);break;case 4:null!=this.device&&i.default.getInstance().changeCubeMap(3,this.device)}}}e.default=o},571:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(185)),i=n(r(512)),o=r(70),s=r(659);e.default=class{constructor(){this.material=new a.default,this.lights=[],this.material.Initialize();for(let t=0;t<o.numOfLight;t++){let t=new i.default;t.Initialize(),this.lights.push(t)}s.vec3.set(this.lights[0].direction,.3,.3,-1),s.vec3.set(this.lights[1].direction,.3,-1,.2),s.vec3.set(this.lights[2].direction,1,.3,-.5)}static getInstance(){return this.instance||(this.instance=new this)}GetLight(t){return this.lights[t]}GetMaterial(){return this.material}}},923:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=a(r(35)),o=a(r(866)),s=a(r(127));e.default=class{constructor(t){this.render=()=>{this.colorTexture=this.context.getCurrentTexture(),this.colorTextureView=this.colorTexture.createView(),this.encodeCommands(),requestAnimationFrame(this.render)},this.canvas=t}initializeAPI(){return n(this,void 0,void 0,(function*(){this.meshes=[];try{const t=navigator.gpu;if(!t)return!1;this.adapter=yield t.requestAdapter(),this.device=yield this.adapter.requestDevice(),this.queue=this.device.queue}catch(t){return console.error(t),!1}return!0}))}resizeBackings(){if(!this.context){this.context=this.canvas.getContext("webgpu");const t={device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:"opaque"};this.context.configure(t)}const t={size:[this.canvas.width,this.canvas.height,1],dimension:"2d",format:"depth24plus-stencil8",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC};this.depthTexture=this.device.createTexture(t),this.depthTextureView=this.depthTexture.createView()}encodeCommands(){const t={colorAttachments:[{view:this.colorTextureView,clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:this.depthTextureView,depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store",stencilClearValue:0,stencilLoadOp:"clear",stencilStoreOp:"store"}};this.commandEncoder=this.device.createCommandEncoder(),this.passEncoder=this.commandEncoder.beginRenderPass(t),this.passEncoder.setViewport(0,0,this.canvas.width,this.canvas.height,0,1),this.passEncoder.setScissorRect(0,0,this.canvas.width,this.canvas.height),this.cubeMapMesh.render(this.passEncoder),this.meshes.forEach((t=>{t.render(this.passEncoder)})),this.passEncoder.end(),this.queue.submit([this.commandEncoder.finish()])}setMesh(t){let e=new i.default(t,this.device);this.meshes.length>=1?this.meshes[0]=e:this.meshes.push(e)}setCubeMapMesh(t){return n(this,void 0,void 0,(function*(){let e=new o.default(t,this.device);yield s.default.getInstance().loadCubeMap(this.device),this.cubeMapMesh=e}))}}},312:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(753)),i=document.getElementById("gfx");new a.default(i).appRun()},866:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(74)),i=n(r(373)),o=n(r(994)),s=n(r(201)),u=n(r(127));class c extends a.default{constructor(t,e){super(t,e)}createShaderModel(){this.vertModule=this.device.createShaderModule({code:i.default}),this.fragModule=this.device.createShaderModule({code:o.default})}createPipeline(){const t={bindGroupLayouts:[this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{viewDimension:"cube"}}]})]},e={layout:this.device.createPipelineLayout(t),vertex:{module:this.vertModule,entryPoint:"main",buffers:[{attributes:[{shaderLocation:0,offset:0,format:"float32x3"}],arrayStride:12,stepMode:"vertex"},{attributes:[{shaderLocation:1,offset:0,format:"float32x4"}],arrayStride:16,stepMode:"vertex"}]},fragment:{module:this.fragModule,entryPoint:"main",targets:[{format:"bgra8unorm"}]},primitive:{frontFace:"cw",cullMode:"none",topology:"triangle-list"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"}};this.pipeline=this.device.createRenderPipeline(e)}render(t){const e=this.device.createBuffer({size:144,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),r=this.device.createSampler({magFilter:"linear",minFilter:"linear",mipmapFilter:"linear"}),n=u.default.getInstance().getCubeMapTexture(),a=this.device.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:e}},{binding:1,resource:r},{binding:2,resource:n.createView({dimension:"cube"})}]}),i=s.default.getInstance(),o=new Float32Array(36);o.set(i.getProjectionMatrix(),0),o.set(i.getViewMatrix(),16),o.set(i.getPosition(),32),this.device.queue.writeBuffer(e,0,o),t.setPipeline(this.pipeline),t.setBindGroup(0,a),t.setVertexBuffer(0,this.positionBuffer),t.setVertexBuffer(1,this.colorBuffer),t.setIndexBuffer(this.indexBuffer,"uint16"),t.drawIndexed(this.numOfIndex)}}e.default=c},35:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(r(74)),i=n(r(201)),o=r(659),s=n(r(958)),u=n(r(995)),c=n(r(571)),h=r(70);class l extends a.default{constructor(t,e){super(t,e),o.mat4.rotateX(this.transform,this.transform,-1.5708),o.mat4.translate(this.transform,this.transform,[0,0,-2])}createShaderModel(){this.vertModule=this.device.createShaderModule({code:s.default}),this.fragModule=this.device.createShaderModule({code:u.default})}createPipeline(){const t={bindGroupLayouts:[this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}},{binding:1,visibility:GPUShaderStage.VERTEX,buffer:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,buffer:{}},{binding:3,visibility:GPUShaderStage.FRAGMENT,buffer:{}},{binding:4,visibility:GPUShaderStage.FRAGMENT,buffer:{}}]})]},e={layout:this.device.createPipelineLayout(t),vertex:{module:this.vertModule,entryPoint:"main",buffers:[{attributes:[{shaderLocation:0,offset:0,format:"float32x3"}],arrayStride:12,stepMode:"vertex"},{attributes:[{shaderLocation:1,offset:0,format:"float32x4"}],arrayStride:16,stepMode:"vertex"},{attributes:[{shaderLocation:2,offset:0,format:"float32x2"}],arrayStride:8,stepMode:"vertex"},{attributes:[{shaderLocation:3,offset:0,format:"float32x3"}],arrayStride:12,stepMode:"vertex"}]},fragment:{module:this.fragModule,entryPoint:"main",targets:[{format:"bgra8unorm"}]},primitive:{frontFace:"cw",cullMode:"none",topology:"triangle-list"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"}};this.pipeline=this.device.createRenderPipeline(e)}render(t){const e=this.device.createBuffer({size:144,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),r=this.device.createBuffer({size:64,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),n=this.device.createBuffer({size:16,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),a=this.device.createBuffer({size:96,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),s=this.device.createBuffer({size:64,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),u=this.device.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:e}},{binding:1,resource:{buffer:r}},{binding:2,resource:{buffer:n}},{binding:3,resource:{buffer:a}},{binding:4,resource:{buffer:s}}]}),l=i.default.getInstance(),f=new Float32Array(36);if(0==this.rotType)o.mat4.rotateZ(this.transform,this.transform,.04);else{const t=o.vec3.create();o.vec3.set(t,this.transform[4],this.transform[5],this.transform[6]),o.vec3.normalize(t,t),o.mat4.rotate(this.transform,this.transform,.04,t)}f.set(l.getProjectionMatrix(),0),f.set(l.getViewMatrix(),16),f.set(l.getPosition(),32),this.device.queue.writeBuffer(e,0,f),this.device.queue.writeBuffer(r,0,this.transform);const m=new Float32Array(4);m.set(l.getPosition(),0),this.device.queue.writeBuffer(n,0,m);const d=c.default.getInstance(),p=new Float32Array(24);for(let t=0;t<h.numOfLight;t++){const e=d.GetLight(t);p.set(e.direction,8*t),p.set([0],8*t+3),p.set(e.color,8*t+4),p.set([e.intensity],8*t+7)}this.device.queue.writeBuffer(a,0,p);const v=new Float32Array(12),M=d.GetMaterial();v.set(M.ambient,0),v.set([0],3),v.set(M.diffuse,4),v.set([0],7),v.set(M.specular,8),v.set([M.shininess],11),this.device.queue.writeBuffer(s,0,v),t.setPipeline(this.pipeline),t.setBindGroup(0,u),t.setVertexBuffer(0,this.positionBuffer),t.setVertexBuffer(1,this.colorBuffer),t.setVertexBuffer(2,this.uvBuffer),t.setVertexBuffer(3,this.normalBuffer),t.setIndexBuffer(this.indexBuffer,"uint16"),t.drawIndexed(this.numOfIndex)}}e.default=l},220:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=r(659),i=n(r(670)),o=n(r(717));e.default=class{constructor(){this.objLoader=new o.default}makeTriangle(t){let e=new Float32Array([-t,-t,0,t,-t,0,0,t,0]),r=new Float32Array([1,0,0,1,0,1,0,1,.5,.5,1,1]),n=new Uint16Array([0,1,2]),a=new Float32Array([0,0,1,0,.5,1]),o=new Float32Array([0,0,1,0,0,1,0,0,1]);return new i.default(e,r,n,a,o)}makeSquare(t){let e=new Float32Array([-t,-t,0,t,-t,0,t,t,0,-t,t,0]),r=new Float32Array([1,1,1,1,0,1,1,1,1,0,1,1,1,1,0,1]),n=new Uint16Array([0,1,2,0,2,3]),a=new Float32Array([0,0,1,0,1,1,0,1]),o=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);return new i.default(e,r,n,a,o)}makeGrid(t,e,r,n){const a=t/r;let o=[],s=[],u=[],c=[],h=[];for(let i=0;i<=n;i++){const c=1-i/(n-1),l=.5*-t,f=e*(.5-c),m=0;for(let t=0;t<=r;t++){let e=t/r;o.push(l+a*t),o.push(f),o.push(m),s.push(i/n),s.push(1-i/n),s.push(0),s.push(1),u.push(e),u.push(c),h.push(0),h.push(0),h.push(1)}}for(let t=0;t<n;t++){const e=t*(r+1);for(let t=e;t<e+r;t++)c.push(t),c.push(t+2+r),c.push(t+1+r),c.push(t),c.push(t+1),c.push(t+2+r)}const l=new Float32Array(o),f=new Float32Array(s),m=new Float32Array(u),d=new Uint16Array(c),p=new Float32Array(h);return new i.default(l,f,d,m,p)}makeBox(t){let e=new Float32Array([-t,t,-t,-t,t,t,t,t,t,t,t,-t,-t,-t,-t,t,-t,-t,t,-t,t,-t,-t,t,-t,-t,-t,-t,t,-t,t,t,-t,t,-t,-t,-t,-t,t,t,-t,t,t,t,t,-t,t,t,-t,-t,t,-t,t,t,-t,t,-t,-t,-t,-t,t,-t,t,t,-t,-t,t,t,-t,t,t,t]),r=new Float32Array([1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1]),n=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),a=new Float32Array([0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1]),o=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]);return new i.default(e,r,n,a,o)}makeAudioMesh(t,e,r){const n=Math.ceil(t.length/r);let i=this.makeGrid(e,1.618*e,r,n),o=i.positions;const s=Math.max(...t),u=Math.min(1,.5*Math.random()+.5);for(let n=0;n<t.length;n++){o[3*n+2]=t[n]/s*e;const c=Math.min(1,t[n]/s+.3);if(i.colors[4*n]=c,i.colors[4*n+1]=.5*(1-c)+.5,i.colors[4*n+2]=u,i.colors[4*n+3]=1,0!=n&&n%r==0)continue;if(n>t.length-1)continue;const h=3*n,l=[o[h],o[h+1],o[h+2]],f=[o[h-3],o[h-2],o[h-1]],m=[o[h+r],o[h+1+r],o[h+2+r]],d=a.vec3.create();a.vec3.subtract(d,l,f),a.vec3.normalize(d,d);const p=a.vec3.create();a.vec3.subtract(p,m,l),a.vec3.normalize(p,p);const v=a.vec3.create();a.vec3.add(v,d,p),a.vec3.normalize(v,v),i.normals[h]=v[0],i.normals[h+1]=v[1],i.normals[h+2]=v[2]}return i}makeObjMesh(t){let e=this.objLoader.parse(t);for(let t=0;t<e.normals.length;t+=3)if(0==e.normals[t]&&0==e.normals[t+1]&&0==e.normals[t+2]){const r=a.vec3.normalize(a.vec3.create(),[e.positions[t],e.positions[t+1],e.positions[t+2]]);e.normals[t]=r[0],e.normals[t+1]=r[1],e.normals[t+2]=r[2]}return e}}},512:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(659);e.default=class{constructor(){this.direction=n.vec3.create(),this.color=n.vec3.create(),this.intensity=0}Initialize(){n.vec3.set(this.direction,0,0,1),n.vec3.set(this.color,1,1,1),this.intensity=1}}},185:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(659);e.default=class{constructor(){this.ambient=n.vec3.create(),this.diffuse=n.vec3.create(),this.specular=n.vec3.create(),this.shininess=0}Initialize(){n.vec3.set(this.ambient,.1,.1,.1),n.vec3.set(this.diffuse,.5,.5,.5),n.vec3.set(this.specular,1,1,1),this.shininess=32}}},74:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(659);e.default=class{constructor(t,e){this.rotType=0,this.meshData=t;const r=(t,r)=>{let n={size:t.byteLength+3&-4,usage:r,mappedAtCreation:!0},a=e.createBuffer(n);return(t instanceof Uint16Array?new Uint16Array(a.getMappedRange()):new Float32Array(a.getMappedRange())).set(t),a.unmap(),a};this.transform=n.mat4.create(),this.device=e,this.createShaderModel(),this.positionBuffer=r(t.positions,GPUBufferUsage.VERTEX),this.colorBuffer=r(t.colors,GPUBufferUsage.VERTEX),this.indexBuffer=r(t.indices,GPUBufferUsage.INDEX),this.uvBuffer=r(t.uv,GPUBufferUsage.VERTEX),this.normalBuffer=r(t.normals,GPUBufferUsage.VERTEX),this.numOfIndex=t.indices.length,this.createPipeline()}createShaderModel(){}createPipeline(){}render(t){}}},670:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,r,n,a){this.positions=t,this.colors=e,this.indices=r,this.uv=n,this.normals=a}}},465:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static exportMeshData(t){let e="";for(let r=0;r<t.positions.length;r+=3)e+=`v ${t.positions[r].toFixed(6)} ${t.positions[r+1].toFixed(6)} ${t.positions[r+2].toFixed(6)}\n`;for(let r=0;r<t.uv.length;r+=2)e+=`vt ${t.uv[r].toFixed(6)} ${t.uv[r+1].toFixed(6)}\n`;for(let r=0;r<t.normals.length;r+=3)e+=`vn ${t.normals[r].toFixed(6)} ${t.normals[r+1].toFixed(6)} ${t.normals[r+2].toFixed(6)}\n`;for(let r=0;r<t.indices.length;r+=3)e+=`f ${t.indices[r]}//${t.indices[r]} ${t.indices[r+1]}//${t.indices[r+1]} ${t.indices[r+2]}//${t.indices[r+2]}\n`;return e}static exportMesh(t){return r.exportMeshData(t.meshData)}}e.default=r},717:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){}parse(t){const e=null==t?void 0:t.split("\n"),r=[],n=[],a=[],i=[];for(const t of e){const e=t.trim(),[o,...s]=e.split(" ");switch(o){case"v":r.push(s.map(parseFloat));break;case"vt":i.push(s.map(Number));break;case"vn":a.push(s.map(parseFloat));break;case"f":n.push(s)}}const o=[],s=[],u=[],c=[];{const t={};let e=0;for(const h of n)for(const n of h){if(void 0!==t[n]){c.push(t[n]);continue}t[n]=e,c.push(e);const[h,l,f]=n.split("/").map((t=>Number(t)-1));h>-1&&o.push(...r[h]),l>-1&&u.push(...i[l]),f>-1&&s.push(...a[f]),e+=1}}return{positions:new Float32Array(o),uv:new Float32Array(u),normals:new Float32Array(s),indices:new Uint16Array(c),colors:new Float32Array(o.length/3*4).fill(.75)}}}},70:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.numOfLight=e.canvasSize=void 0,e.canvasSize=600,e.numOfLight=3;class r{}e.default=r,r.fov=45,r.fovRadian=r.fov*Math.PI/180,r.near=.1,r.far=100},994:t=>{"use strict";t.exports="@group(0) @binding(1) var mySampler: sampler;\r\n@group(0) @binding(2) var myTexture: texture_cube<f32>;\r\n\r\n@fragment\r\nfn main(@location(0) pos: vec4<f32>) -> @location(0) vec4<f32> {\r\n    var cubemapVec = pos.xyz - vec3(0.5);\r\n    return textureSample(myTexture, mySampler, cubemapVec); \r\n}"},373:t=>{"use strict";t.exports="// Declaration of bind groups used by the vertex shader\r\nstruct Camera {\r\n  projection : mat4x4<f32>,\r\n  view : mat4x4<f32>\r\n};\r\n@group(0) @binding(0) var<uniform> camera : Camera;\r\n\r\nstruct VSOut {\r\n  @builtin(position) Position: vec4f,\r\n  @location(0) pos: vec4<f32>,\r\n};\r\n\r\n@vertex\r\nfn main(@location(0) inPos: vec3f,\r\n        @location(1) inColor: vec3f) -> VSOut {\r\n    var vsOut: VSOut;\r\n    vsOut.Position = camera.projection * camera.view * vec4f(inPos, 1);\r\n    vsOut.pos = 0.5 * (vec4(inPos, 1.0) + vec4(1.0, 1.0, 1.0, 1.0));\r\n    return vsOut;\r\n}"},995:t=>{"use strict";t.exports="// 16 bytes의 배수로 맞추기 위한 dummy 변수 선언\r\nstruct Light{\r\n    direction: vec3f,\r\n    dummy1: f32,\r\n    color: vec3f,\r\n    intensity: f32,\r\n};\r\n\r\nstruct Material{\r\n    ambient: vec3f,\r\n    dummy1: f32,\r\n    diffuse: vec3f,\r\n    dummy2: f32,\r\n    specular: vec3f,\r\n    shininess: f32,\r\n};\r\n\r\n@group(0) @binding(2) var<uniform> eyePos: vec4f;\r\n@group(0) @binding(3) var<uniform> light: array<Light, 3>;\r\n@group(0) @binding(4) var<uniform> material: Material;\r\n\r\nfn BlinnPhong(inLight: Light, inMaterial: Material, inNormal: vec3f, inViewDir: vec3f) -> vec3f {\r\n    var ambient = inMaterial.ambient;\r\n    var lightDir = normalize(-inLight.direction);\r\n    var viewDir = normalize(inViewDir);\r\n    var halfDir = normalize(lightDir + viewDir);\r\n    var diff = max(dot(inNormal, lightDir), 0.0);\r\n    var diffuse = inLight.color * inMaterial.diffuse * diff;\r\n    var spec = pow(max(dot(inNormal, halfDir), 0.0), inMaterial.shininess);\r\n    var specular = inLight.color * inMaterial.specular * spec;\r\n    return ambient + (diffuse + specular) * inLight.intensity;\r\n}\r\n\r\nfn computeLighting(inLight: Light, inMaterial: Material, inNormal: vec3f, inViewDir: vec3f) -> vec3f {\r\n    return BlinnPhong(inLight, inMaterial, inNormal, inViewDir);\r\n}\r\n\r\n@fragment\r\nfn main(@location(0) inColor: vec4f,\r\n        @location(1) inNornal: vec3f,\r\n        @location(2) inPos: vec3f) -> @location(0) vec4f {\r\n    var viewDir = normalize(vec3(eyePos.xyz) - inPos);\r\n\r\n    var outColor = computeLighting(light[0], material, inNornal, viewDir);\r\n    outColor += computeLighting(light[1], material, inNornal, viewDir);\r\n    outColor += computeLighting(light[2], material, inNornal, viewDir);\r\n\r\n    return inColor * vec4f(outColor, 1.0);\r\n}"},958:t=>{"use strict";t.exports="struct Camera {\r\n  projection : mat4x4<f32>,\r\n  view : mat4x4<f32>\r\n};\r\n\r\n@group(0) @binding(0) var<uniform> camera : Camera;\r\n@group(0) @binding(1) var<uniform> model : mat4x4<f32>;\r\n\r\nstruct VSOut {\r\n    @builtin(position) Position: vec4f,\r\n    @location(0) color: vec4f,\r\n    @location(1) normal: vec3f,\r\n    @location(2) pos: vec3f\r\n };\r\n\r\n@vertex\r\nfn main(@location(0) inPos: vec3f,\r\n        @location(1) inColor: vec4f,\r\n        @location(2) uv: vec2f,\r\n        @location(3) normal: vec3f) -> VSOut {\r\n    var vsOut: VSOut;\r\n    vsOut.Position = camera.projection * camera.view * model * vec4f(inPos, 1);\r\n    vsOut.color = inColor;\r\n    vsOut.normal = (model * vec4f(normal, 0)).xyz;\r\n    vsOut.pos = inPos;\r\n    return vsOut;\r\n}"}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(312)})();